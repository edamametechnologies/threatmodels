{
  "name": "threat model iOS",
  "extends": "none",
  "date": "April 12th 2023",
  "signature": "ba7816bf8f01dfca424940de6dae2178c19161a606577a0ce410fe93f30013ad",
  "metrics": [
    {
      "name": "edamame helper disabled",
      "metrictype": "bool",
      "dimension": "system services",
      "severity": 5,
      "scope": "generic",
      "tags": [],
      "description": [
        {
          "locale": "EN",
          "title": "Edamame helper inactive",
          "summary": "Edamame's Helper software is not running or requires an update. It's required for maximum Security Score analysis."
        },
        {
          "locale": "FR",
          "title": "Edamame Helper inactif",
          "summary": "Le logiciel d'assistance d'Edamame n'est pas en cours d'exécution ou a besoin d'être mis à jour. Il est requis pour une analyse complète du score de sécurité."
        }
      ],
      "implementation": {
        "system": "iOS",
        "minversion": 15,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "ps -ef | grep edamame_helper | grep -v grep > /dev/null || echo nohelper",
        "education": []
      },
      "remediation": {
        "system": "iOS",
        "minversion": 15,
        "maxversion": 0,
        "class": "installer",
        "elevation": "user",
        "target": "https://edamamecompany.sharepoint.com/:u:/s/Anyone/EW70U3YGjwdFryyIzVo3maMBNE6XAb0ZabQ0Bi0uAw5vsQ?e=7kVnf4",
        "education": []
      },
      "rollback": {
        "system": "iOS",
        "minversion": 15,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "/Library/Application\\ Support/Edamame/Edamame-Helper/uninstall.sh",
        "education": []
      }
    },
    {
      "name": "MDM profiles",
      "metrictype": "bool",
      "dimension": "system integrity",
      "severity": 5,
      "scope": "generic",
      "tags": [],
      "description": [
        {
          "locale": "EN",
          "title": "MDM profiles installed",
          "summary": "You have one or more Mobile Device Management (MDM) profiles installed on your computer. This means that your computer is or can be remotely administered by a 3rd party. If this is your personal computer, this is a grave threat and the profiles should be removed."
        },
        {
          "locale": "FR",
          "title": "Profils MDM installés",
          "summary": "Un ou plusieurs profils de gestion des appareils mobiles (MDM) sont installés sur votre ordinateur. Cela signifie que votre ordinateur est, ou peut être, administré à distance par un tiers. S'il s'agit de votre ordinateur personnel, il s'agit d'une grave menace et les profils doivent être supprimés."
        }
      ],
      "implementation": {
        "system": "iOS",
        "minversion": 15,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "profiles list | grep profileIdentifier",
        "education": []
      },
      "remediation": {
        "system": "iOS",
        "minversion": 15,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "profiles remove -all",
        "education": []
      },
      "rollback": {
        "system": "iOS",
        "minversion": 15,
        "maxversion": 0,
        "class": "",
        "elevation": "",
        "target": "",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://en.wikipedia.org/wiki/Mobile_device_management"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://fr.wikipedia.org/wiki/Mobile_device_management"
          }
        ]
      }
    },
    {
      "name": "manual store application updates",
      "metrictype": "bool",
      "dimension": "applications",
      "severity": 3,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1",
        "iOS_security/sysprefs_software_update_app_update_enforce"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Manual Appstore updates",
          "summary": "Applications are constantly updated to fix potential security issues. It's your best interest to get updates as soon as you can through automatic updates."
        },
        {
          "locale": "FR",
          "title": "Mises à jour Appstore manuelles",
          "summary": "Les applications sont constamment mises à jour pour résoudre les problèmes de sécurité potentiels. Il est dans votre intérêt d'obtenir les mises à jour dès que possible grâce aux mises à jour automatiques."
        }
      ],
      "implementation": {
        "system": "iOS",
        "minversion": 15,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "defaults read /Library/Preferences/com.apple.commerce.plist AutoUpdate 2>&1 | grep -v 1",
        "education": []
      },
      "remediation": {
        "system": "iOS",
        "minversion": 15,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "defaults write /Library/Preferences/com.apple.commerce.plist AutoUpdate -bool true; defaults write /Library/Preferences/com.apple.SoftwareUpdate AutomaticallyInstallAppUpdates -bool true",
        "education": []
      },
      "rollback": {
        "system": "iOS",
        "minversion": 15,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "defaults write /Library/Preferences/com.apple.commerce.plist AutoUpdate -bool false; defaults write /Library/Preferences/com.apple.SoftwareUpdate AutomaticallyInstallAppUpdates -bool false",
        "education": []
      }
    },
    {
      "name": "manual system updates",
      "metrictype": "bool",
      "dimension": "system integrity",
      "severity": 4,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1",
        "iOS_security/sysprefs_install_iOS_updates_enforce",
        "iOS_security/sysprefs_software_update_download_enforce"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Manual system updates",
          "summary": "System updates are manual. Your really should turn on automatic system updates to get the latest security fixes for your computer."
        },
        {
          "locale": "FR",
          "title": "Mises à jour système manuelles",
          "summary": "Les mises à jour du système sont manuelles. Vous devriez vraiment activer les mises à jour automatiques du système pour obtenir les derniers correctifs de sécurité pour votre ordinateur."
        }
      ],
      "implementation": {
        "system": "iOS",
        "minversion": 15,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "defaults read /Library/Preferences/com.apple.SoftwareUpdate AutomaticallyInstalliOSUpdates 2>&1 | grep -v 1",
        "education": []
      },
      "remediation": {
        "system": "iOS",
        "minversion": 15,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "defaults write /Library/Preferences/com.apple.SoftwareUpdate AutomaticCheckEnabled -bool true; defaults write /Library/Preferences/com.apple.SoftwareUpdate AutomaticDownload -bool true; defaults write /Library/Preferences/com.apple.SoftwareUpdate AutomaticallyInstalliOSUpdates -bool true; defaults write /Library/Preferences/com.apple.SoftwareUpdate CriticalUpdateInstall -bool true; defaults write /Library/Preferences/com.apple.SoftwareUpdate ConfigDataInstall -bool true; softwareupdate --schedule on",
        "education": []
      },
      "rollback": {
        "system": "iOS",
        "minversion": 15,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "defaults write /Library/Preferences/com.apple.SoftwareUpdate AutomaticCheckEnabled -bool false; defaults write /Library/Preferences/com.apple.SoftwareUpdate AutomaticDownload -bool false; defaults write /Library/Preferences/com.apple.SoftwareUpdate AutomaticallyInstalliOSUpdates -bool false; defaults write /Library/Preferences/com.apple.SoftwareUpdate CriticalUpdateInstall -bool false; defaults write /Library/Preferences/com.apple.SoftwareUpdate ConfigDataInstall -bool false; softwareupdate --schedule off",
        "education": []
      }
    },
    {
      "name": "too slow or disabled screensaver lock",
      "metrictype": "bool",
      "dimension": "credentials",
      "severity": 3,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1",
        "iOS_security/sysprefs_screensaver_ask_for_password_delay_enforce"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Screen lock disabled",
          "summary": "Your computer doesn't have a screensaver enabled with a password. It leaves it open for phsyical access by anyone. This is very dangerous!"
        },
        {
          "locale": "FR",
          "title": "Ecran protégé désactivé",
          "summary": "Votre ordinateur n'a pas d'économiseur d'écran activé avec un mot de passe. Il le laisse ouvert à l'accès physique par n'importe qui. C'est très dangereux !"
        }
      ],
      "implementation": {
        "system": "iOS",
        "minversion": 15,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "sysadminctl -screenLock status 2>&1 | grep off",
        "education": []
      },
      "remediation": {
        "system": "iOS",
        "minversion": 15,
        "maxversion": 0,
        "class": "",
        "elevation": "",
        "target": "",
        "education": [
          {
            "locale": "EN",
            "class": "youtube",
            "target": "https://www.youtube.com/watch?v=C6of13nZTpM"
          },
          {
            "locale": "FR",
            "class": "youtube",
            "target": "https://www.youtube.com/watch?v=C6of13nZTpM"
          }
        ]
      },
      "rollback": {
        "system": "iOS",
        "minversion": 15,
        "maxversion": 0,
        "class": "",
        "elevation": "",
        "target": "",
        "education": [
          {
            "locale": "EN",
            "class": "youtube",
            "target": "https://www.youtube.com/watch?v=C6of13nZTpM"
          },
          {
            "locale": "FR",
            "class": "youtube",
            "target": "https://www.youtube.com/watch?v=C6of13nZTpM"
          }
        ]
      }
    },
    {
      "name": "installed EPP",
      "metrictype": "bool",
      "dimension": "applications",
      "severity": 4,
      "scope": "generic",
      "tags": [],
      "description": [
        {
          "locale": "EN",
          "title": "No antivirus installed",
          "summary": "You don't have any antivirus installed. We recommend you to install one."
        },
        {
          "locale": "FR",
          "title": "Pas d'antivirus installé",
          "summary": "Vous n'avez pas d'antivirus installé. Nous vous recommandons d'en installer un."
        }
      ],
      "implementation": {
        "system": "iOS",
        "minversion": 15,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "pgrep RTProtectionDaemon >/dev/null || echo noepp",
        "education": []
      },
      "remediation": {
        "system": "iOS",
        "minversion": 15,
        "maxversion": 0,
        "class": "",
        "elevation": "",
        "target": "",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://www.malwarebytes.com/"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://www.malwarebytes.com/"
          }
        ]
      },
      "rollback": {
        "system": "iOS",
        "minversion": 15,
        "maxversion": 0,
        "class": "",
        "elevation": "",
        "target": "",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.malwarebytes.com/hc/en-us/articles/360039023473-Uninstall-and-reinstall-Malwarebytes-using-the-Malwarebytes-Support-Tool"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.malwarebytes.com/hc/en-us/articles/360039023473-Uninstall-and-reinstall-Malwarebytes-using-the-Malwarebytes-Support-Tool"
          }
        ]
      }
    },
    {
      "name": "Jailbroken",
      "metrictype": "bool",
      "dimension": "system integrity",
      "severity": 5,
      "scope": "iOS",
      "tags": ["CIS Benchmark Level 1", "iOS_security/os_sip_enable"],
      "description": [
        {
          "locale": "EN",
          "title": "Your device is jailbroken",
          "summary": "Your device is jailbroken. Either you did it yourself or a bad actor did it to access your personal data. This is very dangerous!"
        },
        {
          "locale": "FR",
          "title": "Votre appareil est jailbreaké",
          "summary": "Votre appareil est jailbreaké. Soit vous l'avez fait vous-même, soit un acteur malveillant l'a fait pour accéder à vos données personnel. C'est très dangereux !"
        }
      ],
      "implementation": {
        "system": "iOS",
        "minversion": 15,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "csrutil status | grep disabled",
        "education": []
      },
      "remediation": {
        "system": "iOS",
        "minversion": 15,
        "maxversion": 0,
        "class": "",
        "elevation": "",
        "target": "",
        "education": [
          {
            "locale": "EN",
            "class": "youtube",
            "target": "https://www.youtube.com/watch?v=Fx_1OPFzu88"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://www.remosoftware.com/info/fr/comment-activer-ou-desactiver-la-protection-de-lintegrite-du-systeme-mac/"
          }
        ]
      },
      "rollback": {
        "system": "iOS",
        "minversion": 15,
        "maxversion": 0,
        "class": "",
        "elevation": "",
        "target": "",
        "education": [
          {
            "locale": "EN",
            "class": "youtube",
            "target": "https://www.youtube.com/watch?v=StAn0ZHiXTc"
          }
        ]
      }
    },
    {
      "name": "pwned",
      "metrictype": "bool",
      "dimension": "credentials",
      "severity": 4,
      "scope": "generic",
      "tags": [],
      "description": [
        {
          "locale": "EN",
          "title": "Compromised Apple ID",
          "summary": "Your Apple ID email has recently appeared in a data breach referenced on haveibeenpwned.com, please review the breach and change your passwords accordingly."
        },
        {
          "locale": "FR",
          "title": "Apple ID compromise",
          "summary": "Votre e-mail Apple ID est apparue récemment dans une fuite de données référencée sur haveibeenpwned.com, veuillez examiner la fuite et modifier vos mots de passe en conséquence."
        }
      ],
      "implementation": {
        "system": "iOS",
        "minversion": 15,
        "maxversion": 0,
        "class": "internal",
        "elevation": "user",
        "target": "pwned -i 365",
        "education": []
      },
      "remediation": {
        "system": "iOS",
        "minversion": 15,
        "maxversion": 0,
        "class": "internal",
        "elevation": "",
        "target": "digitalidentity_manager",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://en.wikipedia.org/wiki/Have_I_Been_Pwned"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://www.futura-sciences.com/tech/actualites/internet-voici-savoir-si-vos-donnees-personnelles-internet-ont-ete-piratees-103095/"
          }
        ]
      },
      "rollback": {
        "system": "iOS",
        "minversion": 15,
        "maxversion": 0,
        "class": "",
        "elevation": "",
        "target": "",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://haveibeenpwned.com/"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://haveibeenpwned.com/"
          }
        ]
      }
    },
    {
      "name": "latest os",
      "metrictype": "bool",
      "dimension": "system integrity",
      "severity": 3,
      "scope": "generic",
      "tags": [],
      "description": [
        {
          "locale": "EN",
          "title": "Your OS is not up to date",
          "summary": "Your operating system is not up to date, please proceed to upgrade to get the latest security patches."
        },
        {
          "locale": "FR",
          "title": "Votre OS n'est pas à jour",
          "summary": "Votre système d'exploitation n'est pas à jour, veuillez procéder à sa mise à niveau afin d'obtenir les derniers correctifs de sécurité."
        }
      ],
      "implementation": {
        "system": "iOS",
        "minversion": 15,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "defaults read /Library/Preferences/com.apple.SoftwareUpdate.plist | grep iOS",
        "education": []
      },
      "remediation": {
        "system": "iOS",
        "minversion": 15,
        "maxversion": 0,
        "class": "",
        "elevation": "",
        "target": "",
        "education": [
          {
            "locale": "EN",
            "class": "youtube",
            "target": "https://www.youtube.com/watch?v=FG2DXkPA93g&t=124s"
          },
          {
            "locale": "FR",
            "class": "youtube",
            "target": "https://www.youtube.com/watch?v=FG2DXkPA93g&t=124s"
          }
        ]
      },
      "rollback": {
        "system": "iOS",
        "minversion": 15,
        "maxversion": 0,
        "class": "",
        "elevation": "",
        "target": "",
        "education": [
          {
            "locale": "EN",
            "class": "youtube",
            "target": "https://www.youtube.com/watch?v=FG2DXkPA93g&t=124s"
          },
          {
            "locale": "FR",
            "class": "youtube",
            "target": "https://www.youtube.com/watch?v=FG2DXkPA93g&t=124s"
          }
        ]
      }
    }
  ]
}
