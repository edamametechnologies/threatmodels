{
  "name": "threat model Windows",
  "extends": "none",
  "date": "June 13th 2023",
  "signature": "d3c82d042efab8e4337317ce7c4071029243f4f4fbad63db13e76347fec487f1",
  "metrics": [
    {
      "name": "edamame helper disabled",
      "metrictype": "bool",
      "dimension": "system services",
      "severity": 5,
      "scope": "generic",
      "tags": [],
      "description": [
        {
          "locale": "EN",
          "title": "Edamame helper inactive",
          "summary": "Edamame's Helper software is not running or requires an update. It's required for maximum Security Score analysis."
        },
        {
          "locale": "FR",
          "title": "Edamame Helper inactif",
          "summary": "Le logiciel d'assistance d'Edamame n'est pas en cours d'ex\u00e9cution ou a besoin d'\u00eatre mis \u00e0 jour. Il est requis pour une analyse compl\u00e8te du score de s\u00e9curit\u00e9."
        }
      ],
      "implementation": {
        "system": "Windows",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "$result = if ((Get-Service -Name edamame_helper -ErrorAction SilentlyContinue).Status -eq 'Running') { \"\" } else { \"no helper\" }; $result\n",
        "education": []
      },
      "remediation": {
        "system": "Windows",
        "minversion": 12,
        "maxversion": 0,
        "class": "installer",
        "elevation": "user",
        "target": "https://edamame-helper.s3.eu-west-1.amazonaws.com/windows/",
        "education": []
      },
      "rollback": {
        "system": "Windows",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "h",
        "education": []
      }
    },
    {
      "name": "Cached logon credentials enabled",
      "metrictype": "bool",
      "dimension": "credentials",
      "severity": 4,
      "scope": "generic",
      "tags": [],
      "description": [
        {
          "locale": "EN",
          "title": "Cached logon credentials enabled",
          "summary": "Cached logon credentials are a security risk as they can be used by attackers to gain access to your system. They are stored on your system and can be retrieved by attackers who gain access to your computer or network. We recommend disabling cached logon credentials to increase the security of your system."
        }
      ],
      "implementation": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "if(((Get-ItemProperty -Path 'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\CredUI' -Name 'DisablePasswordCaching' -ErrorAction SilentlyContinue).DisablePasswordCaching) -eq 1) { 'Password caching is disabled' } else { '' }",
        "education": []
      },
      "remediation": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "reg add 'HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\CredUI' /v DisablePasswordCaching /t REG_DWORD /d 1 /f",
        "education": []
      },
      "rollback": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "reg add 'HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\CredUI' /v DisablePasswordCaching /t REG_DWORD /d 0 /f",
        "education": []
      }
    },
    {
      "name": "Disabled Windows Defender",
      "metrictype": "bool",
      "dimension": "applications",
      "severity": 5,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1",
        "windows_security/wd_disabled"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Windows Defender Disabled",
          "summary": "Windows Defender is a built-in antivirus and antimalware software that comes with Windows. Disabling it can leave your system vulnerable to various threats, such as viruses, Trojans, and spyware."
        },
        {
          "locale": "FR",
          "title": "Windows Defender d\u00e9sactiv\u00e9",
          "summary": "Windows Defender est un logiciel antivirus et antimalware int\u00e9gr\u00e9 \u00e0 Windows. Le d\u00e9sactiver peut laisser votre syst\u00e8me vuln\u00e9rable \u00e0 diverses menaces, telles que des virus, des chevaux de Troie et des logiciels espions."
        }
      ],
      "implementation": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "if((Get-MpPreference | Select-Object -ExpandProperty DisableRealtimeMonitoring) -eq $true) { 'Real-time monitoring is disabled' } else { '' }",
        "education": []
      },
      "remediation": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "Set-MpPreference -DisableRealtimeMonitoring $false",
        "education": []
      },
      "rollback": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "Set-MpPreference -DisableRealtimeMonitoring $true",
        "education": []
      }
    },
    {
      "name": "Automatic updates of App store apps disabled",
      "metrictype": "bool",
      "dimension": "system services",
      "severity": 3,
      "scope": "windows",
      "tags": [
        "CIS Benchmark Level 1",
        "windows_10_1709"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Automatic updates of App store apps disabled",
          "summary": "Automatic updates of App store apps is disabled which may result in outdated apps and pose a risk to security. It is recommended to enable automatic updates of App store apps."
        },
        {
          "locale": "FR",
          "title": "Mises \u00e0 jour automatiques des applications du Windows Store d\u00e9sactiv\u00e9es",
          "summary": "Les mises \u00e0 jour automatiques des applications du Windows Store sont d\u00e9sactiv\u00e9es, ce qui peut entra\u00eener des applications obsol\u00e8tes et repr\u00e9senter un risque pour la s\u00e9curit\u00e9. Il est recommand\u00e9 d'activer les mises \u00e0 jour automatiques des applications du Windows Store."
        }
      ],
      "implementation": {
        "system": "windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "if((Get-ItemProperty -Path 'HKLM:\\SOFTWARE\\Policies\\Microsoft\\WindowsStore' -ErrorAction SilentlyContinue).AutoDownload -ne 4) { 'Automatic updates of App store apps disabled' } else { '' }",
        "education": []
      },
      "remediation": {
        "system": "windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "reg add 'HKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsStore' /v AutoDownload /t REG_DWORD /d 4 /f",
        "education": []
      },
      "rollback": {
        "system": "windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "reg add 'HKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsStore' /v AutoDownload /t REG_DWORD /d 2 /f",
        "education": []
      }
    },
    {
      "name": "UAC disabled",
      "metrictype": "bool",
      "dimension": "system integrity",
      "severity": 5,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 2",
        "windows_security/uac_enable"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "User Account Control disabled",
          "summary": "User Account Control (UAC) is a security feature in Windows that helps prevent unauthorized changes to your computer. If UAC is disabled, it's easier for malware to make changes to your system without your knowledge. You should enable UAC to protect your system from such attacks."
        },
        {
          "locale": "FR",
          "title": "Contr\u00f4le de compte d'utilisateur d\u00e9sactiv\u00e9",
          "summary": "Le Contr\u00f4le de compte d'utilisateur (UAC) est une fonctionnalit\u00e9 de s\u00e9curit\u00e9 dans Windows qui aide \u00e0 pr\u00e9venir les modifications non autoris\u00e9es sur votre ordinateur. Si UAC est d\u00e9sactiv\u00e9, il est plus facile pour les logiciels malveillants de faire des changements sur votre syst\u00e8me sans votre connaissance. Vous devez activer UAC pour prot\u00e9ger votre syst\u00e8me contre de telles attaques."
        }
      ],
      "implementation": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "if((Get-ItemProperty -Path 'HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System' -ErrorAction SilentlyContinue).EnableLUA -eq 0) { 'UAC disabled' } else { '' }",
        "education": []
      },
      "remediation": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "Set-ItemProperty -Path 'HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System' -Name EnableLUA -Value 1 -Type DWord",
        "education": []
      },
      "rollback": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "Set-ItemProperty -Path 'HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System' -Name EnableLUA -Value 0 -Type DWord",
        "education": []
      }
    },
    {
      "name": "SMBv1 enabled",
      "metrictype": "bool",
      "dimension": "network",
      "severity": 5,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1",
        "windows_security/smb1_protocol_disabled"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "SMBv1 Protocol Enabled",
          "summary": "The SMBv1 protocol is enabled on your system. This protocol is outdated and has known vulnerabilities that can allow attackers to take over your system. It should be disabled to improve your system's security."
        },
        {
          "locale": "FR",
          "title": "Protocole SMBv1 activ\u00e9",
          "summary": "Le protocole SMBv1 est activ\u00e9 sur votre syst\u00e8me. Ce protocole est obsol\u00e8te et pr\u00e9sente des vuln\u00e9rabilit\u00e9s connues qui peuvent permettre aux attaquants de prendre le contr\u00f4le de votre syst\u00e8me. Il devrait \u00eatre d\u00e9sactiv\u00e9 pour am\u00e9liorer la s\u00e9curit\u00e9 de votre syst\u00e8me."
        }
      ],
      "implementation": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "if((Get-SmbServerConfiguration).EnableSMB1Protocol -eq $true) { 'SMBv1 enabled' } else { '' }",
        "education": []
      },
      "remediation": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "Disable-WindowsOptionalFeature -Online -FeatureName SMB1Protocol",
        "education": []
      },
      "rollback": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "Enable-WindowsOptionalFeature -Online -FeatureName SMB1Protocol",
        "education": []
      }
    },
    {
      "name": "Automatic logon enabled",
      "metrictype": "bool",
      "dimension": "credentials",
      "severity": 4,
      "scope": "generic",
      "tags": [],
      "description": [
        {
          "locale": "EN",
          "title": "Automatic logon enabled",
          "summary": "Automatic logon allows the system to automatically log on a user after booting up. This can be a security risk if the system is not physically secured as anyone can access the system without providing any credentials. It is recommended to disable automatic logon."
        },
        {
          "locale": "FR",
          "title": "Connexion automatique activ\u00e9e",
          "summary": "La connexion automatique permet au syst\u00e8me de connecter automatiquement un utilisateur apr\u00e8s le d\u00e9marrage. Cela peut \u00eatre un risque pour la s\u00e9curit\u00e9 si le syst\u00e8me n'est pas physiquement s\u00e9curis\u00e9 car n'importe qui peut acc\u00e9der au syst\u00e8me sans fournir de credentials. Il est recommand\u00e9 de d\u00e9sactiver la connexion automatique."
        }
      ],
      "implementation": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "if((Get-ItemProperty -Path 'HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon' -ErrorAction SilentlyContinue).AutoAdminLogon -eq '1') { 'Automatic logon enabled' } else { '' }",
        "education": []
      },
      "remediation": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "Set-ItemProperty -Path 'HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon' -Name AutoAdminLogon -Value 0",
        "education": []
      },
      "rollback": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "Set-ItemProperty -Path 'HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon' -Name AutoAdminLogon -Value 1",
        "education": []
      }
    },
    {
      "name": "Windows Script Host enabled",
      "metrictype": "bool",
      "dimension": "system integrity",
      "severity": 4,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1",
        "windows_security/disable_wscript_host"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Windows Script Host enabled",
          "summary": "Windows Script Host is a built-in Windows scripting environment that allows running of VBScript, JScript, and other scripting languages. Disabling it can help mitigate some types of malware attacks."
        },
        {
          "locale": "FR",
          "title": "Windows Script Host activ\u00e9",
          "summary": "Windows Script Host est un environnement de script Windows int\u00e9gr\u00e9 qui permet l'ex\u00e9cution de VBScript, JScript et d'autres langages de script. Le d\u00e9sactiver peut aider \u00e0 att\u00e9nuer certains types d'attaques de logiciels malveillants."
        }
      ],
      "implementation": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "if((Get-ItemProperty -Path 'HKLM:\\SOFTWARE\\Microsoft\\Windows Script Host\\Settings' -Name Enabled -ErrorAction SilentlyContinue).Enabled -eq 1) { 'Windows Script Host enabled' } else { '' }",
        "education": []
      },
      "remediation": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "reg add 'HKLM\\SOFTWARE\\Microsoft\\Windows Script Host\\Settings' /v Enabled /t REG_DWORD /d 0 /f",
        "education": []
      },
      "rollback": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "reg add 'HKLM\\SOFTWARE\\Microsoft\\Windows Script Host\\Settings' /v Enabled /t REG_DWORD /d 1 /f",
        "education": []
      }
    },
    {
      "name": "RDP enabled",
      "metrictype": "bool",
      "dimension": "network",
      "severity": 4,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1",
        "windows_security/rdp_enable"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Remote Desktop Protocol (RDP) enabled",
          "summary": "RDP allows users to remotely access and control a Windows computer from another location. While this can be convenient, it also presents a significant security risk if left enabled and unprotected. An attacker could potentially gain access to your computer and compromise your sensitive data or even take control of your system."
        },
        {
          "locale": "FR",
          "title": "Protocole de Bureau \u00e0 distance (RDP) activ\u00e9",
          "summary": "RDP permet aux utilisateurs d'acc\u00e9der \u00e0 distance et de contr\u00f4ler un ordinateur Windows \u00e0 partir d'un autre emplacement. Bien que cela puisse \u00eatre pratique, cela pr\u00e9sente \u00e9galement un risque de s\u00e9curit\u00e9 important s'il est laiss\u00e9 activ\u00e9 et non prot\u00e9g\u00e9. Un attaquant pourrait potentiellement acc\u00e9der \u00e0 votre ordinateur et compromettre vos donn\u00e9es sensibles ou m\u00eame prendre le contr\u00f4le de votre syst\u00e8me."
        }
      ],
      "implementation": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "if((Get-ItemProperty -Path 'HKLM:\\System\\CurrentControlSet\\Control\\Terminal Server' -Name fDenyTSConnections -ErrorAction SilentlyContinue) -eq 0) { 'Terminal Services connections allowed' } else { '' }",
        "education": []
      },
      "remediation": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "Set-ItemProperty -Path 'HKLM:\\System\\CurrentControlSet\\Control\\Terminal Server' -Name fDenyTSConnections -Value 1",
        "education": []
      },
      "rollback": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "Set-ItemProperty -Path 'HKLM:\\System\\CurrentControlSet\\Control\\Terminal Server' -Name fDenyTSConnections -Value 0",
        "education": []
      }
    },
    {
      "name": "Windows Update disabled",
      "metrictype": "bool",
      "dimension": "system integrity",
      "severity": 5,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1",
        "windows_security/update_automatic_updates"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Windows Update disabled",
          "summary": "Disabling Windows Update prevents critical security patches and updates from being installed on your system, leaving your system vulnerable to known exploits and threats. It is highly recommended that you enable Windows Update to ensure your system is up to date with the latest security patches."
        },
        {
          "locale": "FR",
          "title": "Mise \u00e0 jour Windows d\u00e9sactiv\u00e9e",
          "summary": "La d\u00e9sactivation de la mise \u00e0 jour de Windows emp\u00eache l'installation des correctifs et des mises \u00e0 jour de s\u00e9curit\u00e9 critiques sur votre syst\u00e8me, laissant votre syst\u00e8me vuln\u00e9rable aux exploits et menaces connus. Il est fortement recommand\u00e9 d'activer la mise \u00e0 jour de Windows pour garantir que votre syst\u00e8me est \u00e0 jour avec les derniers correctifs de s\u00e9curit\u00e9."
        }
      ],
      "implementation": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "if((Get-ItemProperty -Path 'HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU' -Name NoAutoUpdate -ErrorAction SilentlyContinue) -ne $null) { 'NoAutoUpdate is set' } else { '' }",
        "education": []
      },
      "remediation": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "reg add 'HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU' /v NoAutoUpdate /t REG_DWORD /d 0 /f",
        "education": []
      },
      "rollback": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "reg add 'HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU' /v NoAutoUpdate /t REG_DWORD /d 1 /f",
        "education": []
      }
    },
    {
      "name": "Guest account enabled",
      "metrictype": "bool",
      "dimension": "credentials",
      "severity": 4,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1",
        "windows_security/accounts_guest_account"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Guest account enabled",
          "summary": "The Guest account is a default account in Windows, which allows users to access the system with limited privileges. It's recommended to disable this account to prevent unauthorized access to your system and data."
        },
        {
          "locale": "FR",
          "title": "Compte Invit\u00e9 activ\u00e9",
          "summary": "Le compte Invit\u00e9 est un compte par d\u00e9faut dans Windows, qui permet aux utilisateurs d'acc\u00e9der au syst\u00e8me avec des privil\u00e8ges limit\u00e9s. Il est recommand\u00e9 de d\u00e9sactiver ce compte pour emp\u00eacher tout acc\u00e8s non autoris\u00e9 \u00e0 votre syst\u00e8me et \u00e0 vos donn\u00e9es."
        }
      ],
      "implementation": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "if((Get-WmiObject -Class Win32_UserAccount | Where-Object {$_.Name -eq 'Guest'} | Select-Object -Property Name).Name -eq 'Guest') { 'Guest account exists' } else { '' }",
        "education": []
      },
      "remediation": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "Disable-LocalUser -Name Guest",
        "education": []
      },
      "rollback": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "Enable-LocalUser -Name Guest",
        "education": []
      }
    },
    {
      "name": "Autoplay enabled",
      "metrictype": "bool",
      "dimension": "system services",
      "severity": 3,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1",
        "windows_security/windows_autoplay_disable"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Autoplay enabled",
          "summary": "Autoplay is a feature in Windows that can automatically launch an application when you plug in a USB drive, CD or DVD. This can be used by attackers to run malicious code without your consent or knowledge."
        },
        {
          "locale": "FR",
          "title": "Lecture automatique activ\u00e9e",
          "summary": "La lecture automatique est une fonctionnalit\u00e9 de Windows qui peut lancer automatiquement une application lorsque vous branchez une cl\u00e9 USB, un CD ou un DVD. Cela peut \u00eatre utilis\u00e9 par des attaquants pour ex\u00e9cuter un code malveillant sans votre consentement ni votre connaissance."
        }
      ],
      "implementation": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "if((Get-ItemProperty -Path 'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer' -Name NoDriveTypeAutoRun -ErrorAction SilentlyContinue).NoDriveTypeAutoRun -ne 0xFF) { 'Autoplay enabled' } else { '' }",
        "education": []
      },
      "remediation": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "Set-ItemProperty -Path 'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer' -Name NoDriveTypeAutoRun -Type DWord -Value 0xFF -Force",
        "education": []
      },
      "rollback": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "Set-ItemProperty -Path 'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer' -Name NoDriveTypeAutoRun -Type DWord -Value 0x91 -Force",
        "education": []
      }
    },
    {
      "name": "Built-in admin account enabled",
      "metrictype": "bool",
      "dimension": "credentials",
      "severity": 5,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1",
        "windows_security/wi_accounts_enableadmin"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Built-in Administrator account enabled",
          "summary": "The Built-in Administrator account is a powerful account that has full access to the system. Having this account enabled is a security risk as it is a common target for attackers. It should be disabled unless it is absolutely necessary to enable it."
        },
        {
          "locale": "FR",
          "title": "Compte administrateur int\u00e9gr\u00e9 activ\u00e9",
          "summary": "Le compte administrateur int\u00e9gr\u00e9 est un compte puissant qui a un acc\u00e8s complet au syst\u00e8me. Avoir ce compte activ\u00e9 repr\u00e9sente un risque de s\u00e9curit\u00e9 car c'est une cible courante pour les attaquants. Il devrait \u00eatre d\u00e9sactiv\u00e9 sauf s'il est absolument n\u00e9cessaire de l'activer."
        }
      ],
      "implementation": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "if((net user Administrator | findstr /C:'Account active') -match 'Yes') { 'Administrator account is active' } else { '' }",
        "education": []
      },
      "remediation": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "net user Administrator /active:no",
        "education": []
      },
      "rollback": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "net user Administrator /active:yes",
        "education": []
      }
    },
    {
      "name": "Windows Firewall disabled",
      "metrictype": "bool",
      "dimension": "network",
      "severity": 5,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1",
        "windows_security/win_fw_enable"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Windows Firewall disabled",
          "summary": "Windows Firewall is a built-in feature of Windows that helps to protect your computer from unauthorized access. When it's disabled, your computer is vulnerable to attacks from the network. We recommend that you enable it."
        },
        {
          "locale": "FR",
          "title": "Pare-feu Windows d\u00e9sactiv\u00e9",
          "summary": "Le pare-feu Windows est une fonctionnalit\u00e9 int\u00e9gr\u00e9e de Windows qui aide \u00e0 prot\u00e9ger votre ordinateur contre les acc\u00e8s non autoris\u00e9s. Lorsqu'il est d\u00e9sactiv\u00e9, votre ordinateur est vuln\u00e9rable aux attaques en provenance du r\u00e9seau. Nous vous recommandons de l'activer."
        }
      ],
      "implementation": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "if((Get-NetFirewallProfile -All | Where-Object { $_.Enabled -eq 'False' })) { 'One or more firewall profiles are disabled' } else { '' }",
        "education": []
      },
      "remediation": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True",
        "education": []
      },
      "rollback": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled False",
        "education": []
      }
    },
    {
      "name": "Remote Registry Service enabled",
      "metrictype": "bool",
      "dimension": "system services",
      "severity": 3,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1",
        "windows_security/registry_remote_access"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Remote Registry Service enabled",
          "summary": "The Remote Registry Service allows remote access to the Windows Registry. This can be a security risk if not properly secured."
        },
        {
          "locale": "FR",
          "title": "Service Registre distant activ\u00e9",
          "summary": "Le Service Registre distant permet l'acc\u00e8s distant au Registre de Windows. Cela peut \u00eatre un risque de s\u00e9curit\u00e9 si cela n'est pas correctement s\u00e9curis\u00e9."
        }
      ],
      "implementation": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "if((Get-Service -Name RemoteRegistry).Status -eq 'Running') { 'RemoteRegistry service is running' } else { '' }",
        "education": []
      },
      "remediation": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "sc config RemoteRegistry start= disabled && sc stop RemoteRegistry",
        "education": []
      },
      "rollback": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "sc config RemoteRegistry start= auto && sc start RemoteRegistry",
        "education": []
      }
    },
    {
      "name": "LM and NTLMv1 enabled",
      "metrictype": "bool",
      "dimension": "credentials",
      "severity": 5,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1",
        "windows_security/cred_lm_ntlmv1"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "LM and NTLMv1 protocols enabled",
          "summary": "The LM and NTLMv1 protocols are outdated and insecure authentication protocols. They should be disabled to prevent potential security threats. Leaving these protocols enabled can allow attackers to potentially crack passwords and gain unauthorized access to sensitive information."
        }
      ],
      "implementation": {
        "system": "Windows",
        "minversion": 0,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "if(((Get-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa' -ErrorAction SilentlyContinue).LmCompatibilityLevel -lt 5) -or ((Get-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\MSV1_0' -ErrorAction SilentlyContinue).NtlmMinClientSec -lt 537395200) -or ((Get-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\MSV1_0' -ErrorAction SilentlyContinue).NtlmMinServerSec -lt 537395200)) { 'Weak NTLM settings' } else { '' }",
        "education": []
      },
      "remediation": {
        "system": "Windows",
        "minversion": 0,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "Set-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\LmCompatibilityLevel' -Value '5' -Type DWord; Set-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\MSV1_0' -Name 'NtlmMinClientSec' -Value '537395200' -Type DWord; Set-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\MSV1_0' -Name 'NtlmMinServerSec' -Value '537395200' -Type DWord",
        "education": []
      },
      "rollback": {
        "system": "Windows",
        "minversion": 0,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "Set-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\LmCompatibilityLevel' -Value '1' -Type DWord; Set-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\MSV1_0' -Name 'NtlmMinClientSec' -Value '262144' -Type DWord; Set-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\MSV1_0' -Name 'NtlmMinServerSec' -Value '537395200' -Type DWord",
        "education": []
      }
    },
    {
      "name": "Lsass process protection",
      "metrictype": "bool",
      "dimension": "system integrity",
      "severity": 4,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1",
        "windows_security/os_lsass_protection"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Lsass.exe process protection not enabled",
          "summary": "Lsass.exe is a critical system process that handles user authentication. It contains sensitive information such as passwords and security tokens. If this process is compromised, it could lead to a security breach. Enabling Lsass.exe process protection helps prevent attacks against this process. This content will show you how to enable Lsass.exe process protection."
        },
        {
          "locale": "FR",
          "title": "Protection du processus Lsass.exe d\u00e9sactiv\u00e9e",
          "summary": "Lsass.exe est un processus syst\u00e8me essentiel qui g\u00e8re l'authentification de l'utilisateur. Il contient des informations sensibles telles que des mots de passe et des jetons de s\u00e9curit\u00e9. Si ce processus est compromis, cela peut entra\u00eener une violation de s\u00e9curit\u00e9. L'activation de la protection du processus Lsass.exe aide \u00e0 pr\u00e9venir les attaques contre ce processus. Ce contenu vous montrera comment activer la protection du processus Lsass.exe."
        }
      ],
      "implementation": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "if((Get-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa' -ErrorAction SilentlyContinue).RunAsPPL -eq 0) { 'RunAsPPL is a REG_DWORD with value 0' } else { '' }",
        "education": []
      },
      "remediation": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "reg admin 'HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa' /v 'RunAsPPL' /t REG_DWORD /d 1 /f",
        "education": []
      },
      "rollback": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "reg add HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa /v 'RunAsPPL' /t REG_DWORD /d 0 /f",
        "education": []
      }
    },
    {
      "name": "ps not RemoteSigned",
      "metrictype": "bool",
      "dimension": "system integrity",
      "severity": 4,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1",
        "windows_security/powershell/executionpolicy"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "PowerShell execution policy not set to RemoteSigned",
          "summary": "PowerShell is a powerful command-line tool that is built into Windows, and is often used by attackers to carry out malicious activities. The execution policy determines which scripts are allowed to run on a Windows system. If the execution policy is not set to RemoteSigned, it could allow an attacker to run malicious scripts on your system."
        },
        {
          "locale": "FR",
          "title": "La strat\u00e9gie d'ex\u00e9cution de PowerShell n'est pas d\u00e9finie sur RemoteSigned",
          "summary": "PowerShell est un outil en ligne de commande puissant int\u00e9gr\u00e9 \u00e0 Windows, souvent utilis\u00e9 par des attaquants pour effectuer des activit\u00e9s malveillantes. La strat\u00e9gie d'ex\u00e9cution d\u00e9termine les scripts autoris\u00e9s \u00e0 s'ex\u00e9cuter sur un syst\u00e8me Windows. Si la strat\u00e9gie d'ex\u00e9cution n'est pas d\u00e9finie sur RemoteSigned, cela pourrait permettre \u00e0 un attaquant d'ex\u00e9cuter des scripts malveillants sur votre syst\u00e8me."
        }
      ],
      "implementation": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "if((Get-ExecutionPolicy) -ne 'RemoteSigned') { 'Execution Policy not RemoteSigned' } else { '' }",
        "education": []
      },
      "remediation": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Force",
        "education": []
      },
      "rollback": {
        "system": "Windows",
        "minversion": 10,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "Set-ExecutionPolicy -ExecutionPolicy Unrestricted -Force",
        "education": []
      }
    }
  ]
}