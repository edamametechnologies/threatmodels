{
  "name": "threat model macOS",
  "extends": "none",
  "date": "November 03th 2024",
  "signature": "ee52284e3010f8111289d49e7fbe7072aa37511f5b23ecbe7fcebe1a95932672",
  "metrics": [
    {
      "name": "edamame helper disabled",
      "metrictype": "bool",
      "dimension": "system services",
      "severity": 5,
      "scope": "generic",
      "tags": [],
      "description": [
        {
          "locale": "EN",
          "title": "EDAMAME helper inactive",
          "summary": "EDAMAME's Helper software is not running or requires an update. It's required for complete Security Score analysis and remediation."
        },
        {
          "locale": "FR",
          "title": "EDAMAME Helper inactif",
          "summary": "Le logiciel d'assistance d'EDAMAME n'est pas en cours d'exécution ou a besoin d'être mis à jour. Il est requis pour une analyse complète du score de sécurité."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "internal",
        "elevation": "user",
        "target": "helper_check",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "installer",
        "elevation": "user",
        "target": "https://github.com/edamametechnologies/edamame_helper/releases/download",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://github.com/edamametechnologies/edamame_helper"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://github.com/edamametechnologies/edamame_helper"
          }
        ]
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "/Library/Application\\ Support/Edamame/Edamame-Helper/uninstall.sh",
        "education": [
          {
            "locale": "EN",
            "class": "html",
            "target": "If you need to uninstall the EDAMAME Helper software for any reason, you can use the provided shell script command. Note that uninstalling may affect the Security Score analysis of your system."
          },
          {
            "locale": "FR",
            "class": "html",
            "target": "Si vous devez désinstaller le logiciel d'assistance EDAMAME pour une raison quelconque, vous pouvez utiliser la commande de script shell fournie. Notez que la désinstallation peut affecter l'analyse du score de sécurité de votre système."
          }
        ]
      }
    },
    {
      "name": "response to ping enabled",
      "metrictype": "bool",
      "dimension": "network",
      "severity": 3,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1,macos_security/sysprefs_firewall_stealth_mode_enable",
        "ISO 27001/2,Communications Security",
        "PCI-DSS,Requirement-1",
        "SOC 2,CC-System Operations"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Response to ping enabled",
          "summary": "Your computer will respond if anything on the network is trying to check its presence. This can be very bad and allow anyone to check your presence and possibly attack your computer."
        },
        {
          "locale": "FR",
          "title": "Réponse au ping activée",
          "summary": "Votre ordinateur répondra si quelque chose essaie de vérifier sa présence. Cela peut être très mauvais et permettre à quiconque de vérifier votre présence sur un réseau et éventuellement d'attaquer votre ordinateur."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "/usr/libexec/ApplicationFirewall/socketfilterfw --getstealthmode | grep disabled",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "/usr/libexec/ApplicationFirewall/socketfilterfw --setstealthmode on",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/en-us/guide/mac-help/mh11783/mac"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/guide/mac-help/mh11783/mac"
          }
        ]
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "/usr/libexec/ApplicationFirewall/socketfilterfw --setstealthmode off",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/en-us/guide/mac-help/mh11783/mac"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/guide/mac-help/mh11783/mac"
          }
        ]
      }
    },
    {
      "name": "MDM profiles",
      "metrictype": "bool",
      "dimension": "system integrity",
      "severity": 5,
      "scope": "generic",
      "tags": [
        "Personal Posture"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "MDM profiles installed",
          "summary": "You have one or more Mobile Device Management (MDM) profiles installed on your device. This means that your device is or can be remotely administered by a 3rd party. If this is your personal computer, this is a grave threat and the profiles should be removed."
        },
        {
          "locale": "FR",
          "title": "Profils MDM installés",
          "summary": "Un ou plusieurs profils de gestion des appareils mobiles (MDM) sont installés sur votre appareil. Cela signifie que votre appareil est, ou peut être, administré à distance par un tiers. S'il s'agit de votre ordinateur personnel, il s'agit d'une grave menace et les profils doivent être supprimés."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "profiles -P | grep profileIdentifier",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "link",
        "elevation": "",
        "target": "x-apple.systempreferences:com.apple.preferences.configurationprofiles",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/en-us/guide/deployment/depc0aadd3fe/web"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/guide/deployment/depc0aadd3fe/web"
          }
        ]
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "link",
        "elevation": "",
        "target": "x-apple.systempreferences:com.apple.preferences.configurationprofiles",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/en-us/guide/deployment/depc0aadd3fe/web"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/guide/deployment/depc0aadd3fe/web"
          }
        ]
      }
    },
    {
      "name": "MDM remote admin",
      "metrictype": "bool",
      "dimension": "system integrity",
      "severity": 5,
      "scope": "macOS",
      "tags": [
        "Personal Posture"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "JAMF remote administration enabled",
          "summary": "Your computer is or can be remotely administered by a 3rd party using the JAMF MDM framework. If this is your personal computer, this is a grave threat and JAMF should be removed."
        },
        {
          "locale": "FR",
          "title": "Administration à distance JAMF installée",
          "summary": "Votre ordinateur est, ou peut être, administré à distance par un tiers à l'aide du framework JAMF MDM. S'il s'agit de votre ordinateur personnel, il s'agit d'une grave menace et JAMF doit être supprimé."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "pgrep jamf",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "jamf removeFramework",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://learn.jamf.com/en-US/bundle/jamf-connect-documentation-current/page/Uninstalling_Jamf_Connect.html"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://learn.jamf.com/fr-FR/bundle/jamf-connect-documentation-current/page/Uninstalling_Jamf_Connect.html"
          }
        ]
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "link",
        "elevation": "",
        "target": "https://www.jamf.com",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://www.jamf.com"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://www.jamf.com/fr"
          }
        ]
      }
    },
    {
      "name": "WOL enabled",
      "metrictype": "bool",
      "dimension": "network",
      "severity": 1,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1,macos_security/sysprefs_wake_network_access_disable",
        "ISO 27001/2,Communications Security",
        "PCI-DSS,Requirement-1",
        "SOC 2,CC-System Operations"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Wake On LAN enabled",
          "summary": "Wake on LAN is a feature that can wake up your computer automatically when something is attempting to connect to it. This is not something you need in most cases and it can allow an attacker to connect to your computer at any time."
        },
        {
          "locale": "FR",
          "title": "Wake On LAN activé",
          "summary": "Wake on LAN est une fonctionnalité qui peut réveiller automatiquement votre ordinateur lorsque quelque chose tente de s'y connecter. Ce n'est pas quelque chose dont vous avez besoin dans la plupart des cas et cela peut permettre à un malfrat de se connecter à votre ordinateur à tout moment."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "systemsetup getwakeonnetworkaccess | grep -v Off",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "link",
        "elevation": "",
        "target": "x-apple.systempreferences:com.apple.preference.energy",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/guide/mac-help/set-sleep-and-wake-settings-mchlp2996/mac"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/guide/mac-help/set-sleep-and-wake-settings-mchlp2996/mac"
          }
        ]
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "link",
        "elevation": "",
        "target": "x-apple.systempreferences:com.apple.preference.energy",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/guide/mac-help/set-sleep-and-wake-settings-mchlp2996/mac"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/guide/mac-help/set-sleep-and-wake-settings-mchlp2996/mac"
          }
        ]
      }
    },
    {
      "name": "manual store application updates",
      "metrictype": "bool",
      "dimension": "applications",
      "severity": 3,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1,macos_security/sysprefs_software_update_app_update_enforce",
        "ISO 27001/2,Information Systems Acquisition, Development, and Maintenance",
        "PCI-DSS,Requirement-6",
        "SOC 2,CC-System Development and Maintenance"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Manual App Store updates",
          "summary": "Applications are constantly updated to fix potential security issues. It's in your best interest to get updates as soon as you can through automatic updates."
        },
        {
          "locale": "FR",
          "title": "Mises à jour App Store manuelles",
          "summary": "Les applications sont constamment mises à jour pour résoudre les problèmes de sécurité potentiels. Il est dans votre intérêt d'obtenir les mises à jour dès que possible grâce aux mises à jour automatiques."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "globalpreferences",
        "target": "defaults read /Library/Preferences/com.apple.commerce.plist AutoUpdate 2>&1 | grep -v 1",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "link",
        "elevation": "",
        "target": "x-apple.systempreferences:com.apple.preferences.softwareupdate",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/en-us/102629"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/102629"
          }
        ]
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "link",
        "elevation": "",
        "target": "x-apple.systempreferences:com.apple.preferences.softwareupdate",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/en-us/102629"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/102629"
          }
        ]
      }
    },
    {
      "name": "local firewall disabled",
      "metrictype": "bool",
      "dimension": "network",
      "severity": 2,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1,macos_security/sysprefs_firewall_enable",
        "ISO 27001/2,Communications Security",
        "PCI-DSS,Requirement-1",
        "SOC 2,CC-Network Protection"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Local firewall disabled",
          "summary": "Your local firewall is disabled. This is fine in a trusted environment but dangerous if you happen to connect to public networks. You should turn it on by default."
        },
        {
          "locale": "FR",
          "title": "Pare-feu local désactivé",
          "summary": "Votre pare-feu local est désactivé. C'est bien dans un environnement de confiance mais dangereux si vous vous connectez à des réseaux publics. Vous devriez l'activer par défaut."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "/usr/libexec/ApplicationFirewall/socketfilterfw --getglobalstate | grep disabled",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "link",
        "elevation": "",
        "target": "x-apple.systempreferences:com.apple.preference.security?Firewall",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/en-en/guide/mac-help/mh34041/mac"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/guide/mac-help/mh34041/mac"
          }
        ]
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "link",
        "elevation": "",
        "target": "x-apple.systempreferences:com.apple.preference.security?Firewall",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/en-en/guide/mac-help/mh34041/mac"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/guide/mac-help/mh34041/mac"
          }
        ]
      }
    },
    {
      "name": "automatic login enabled",
      "metrictype": "bool",
      "dimension": "credentials",
      "severity": 4,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1,macos_security/sysprefs_automatic_login_disable",
        "ISO 27001/2,Access Control",
        "PCI-DSS,Requirement-8",
        "SOC 2,CC-Logical Access"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Automatic login enabled",
          "summary": "Automatic login could appear as very handy but in fact it's a major security threat: it allows anyone to access your data without knowing your password."
        },
        {
          "locale": "FR",
          "title": "Login automatique activé",
          "summary": "La connexion automatique peut sembler très pratique mais en fait c'est une menace majeure pour la sécurité : elle permet à n'importe qui d'accéder à vos données sans connaître votre mot de passe."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "globalpreferences",
        "target": "defaults read /Library/Preferences/com.apple.loginwindow | grep autoLoginUser",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "link",
        "elevation": "",
        "target": "x-apple.systempreferences:com.apple.preferences.users",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/en-us/102316"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/102316"
          }
        ]
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "link",
        "elevation": "",
        "target": "x-apple.systempreferences:com.apple.preferences.users",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/en-us/102316"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/102316"
          }
        ]
      }
    },
    {
      "name": "remote login enabled",
      "metrictype": "bool",
      "dimension": "system integrity",
      "severity": 4,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1,macos_security/sysprefs_ssh_disable",
        "ISO 27001/2,Access Control",
        "PCI-DSS,Requirement-8",
        "SOC 2,CC-System Integrity"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Remote login enabled",
          "summary": "Remote login is enabled. This is not necessary unless you are an IT professional. This is unusual and dangerous for most users."
        },
        {
          "locale": "FR",
          "title": "Accès à distance activé",
          "summary": "L'accès à distance est activée. Ce n'est pas nécessaire sauf si vous êtes un professionnel de l'informatique. Ceci est inhabituel et dangereux pour la plupart des utilisateurs."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "systemsetup -getremotelogin | grep On",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "link",
        "elevation": "",
        "target": "x-apple.systempreferences:com.apple.sharing?Services_Root=SSH",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/guide/mac-help/allow-remote-login-ssh-on-your-mac-mh43185/mac"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/guide/mac-help/allow-remote-login-ssh-on-your-mac-mh43185/mac"
          }
        ]
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "link",
        "elevation": "",
        "target": "x-apple.systempreferences:com.apple.sharing?Services_Root=SSH",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/guide/mac-help/allow-remote-login-ssh-on-your-mac-mh43185/mac"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/guide/mac-help/allow-remote-login-ssh-on-your-mac-mh43185/mac"
          }
        ]
      }
    },
    {
      "name": "remote desktop enabled",
      "metrictype": "bool",
      "dimension": "system integrity",
      "severity": 4,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1,macos_security/sysprefs_remote_management_disable",
        "ISO 27001/2,Access Control",
        "PCI-DSS,Requirement-8",
        "SOC 2,CC-System Integrity"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Remote desktop enabled",
          "summary": "Remote desktop is enabled. This is not necessary unless you are an IT professional. This is unusual and dangerous for most users."
        },
        {
          "locale": "FR",
          "title": "Bureau à distance activé",
          "summary": "La connexion au bureau à distance est activée. Ce n'est pas nécessaire sauf si vous êtes un professionnel de l'informatique. Ceci est inhabituel et dangereux pour la plupart des utilisateurs."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "pgrep ARDAgent",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "link",
        "elevation": "",
        "target": "x-apple.systempreferences:com.apple.sharing?Services_Root=ARDService",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/guide/mac-help/allow-others-to-access-your-mac-remote-desktop-mh11848/mac"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/guide/mac-help/allow-others-to-access-your-mac-remote-desktop-mh11848/mac"
          }
        ]
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "link",
        "elevation": "",
        "target": "x-apple.systempreferences:com.apple.sharing?Services_Root=ARDService",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/guide/mac-help/allow-others-to-access-your-mac-remote-desktop-mh11848/mac"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/guide/mac-help/allow-others-to-access-your-mac-remote-desktop-mh11848/mac"
          }
        ]
      }
    },
    {
      "name": "file sharing enabled",
      "metrictype": "bool",
      "dimension": "system services",
      "severity": 4,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1,macos_security/sysprefs_smbd_disable",
        "ISO 27001/2,Information Security Policies",
        "PCI-DSS,Requirement-9",
        "SOC 2,CC-System Services"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "File sharing enabled",
          "summary": "File sharing is enabled. While this could be intentional, we strongly recommend turning it off. It's not easy to configure securely and can expose your data to unwanted people."
        },
        {
          "locale": "FR",
          "title": "Partage de fichiers activé",
          "summary": "Le partage de fichiers est activé. Bien que cela puisse être intentionnel, nous vous recommandons fortement de le désactiver. Ce n'est pas si facile à configurer et cela peut exposer vos données à des personnes indésirables."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "launchctl list | grep smbd",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "link",
        "elevation": "",
        "target": "x-apple.systempreferences:com.apple.sharing?Services_Root=PersonalFileSharing",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/guide/mac-help/set-up-file-sharing-on-mac-mh17131/mac"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/guide/mac-help/set-up-file-sharing-on-mac-mh17131/mac"
          }
        ]
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "link",
        "elevation": "",
        "target": "x-apple.systempreferences:com.apple.sharing?Services_Root=PersonalFileSharing",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/guide/mac-help/set-up-file-sharing-on-mac-mh17131/mac"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/guide/mac-help/set-up-file-sharing-on-mac-mh17131/mac"
          }
        ]
      }
    },
    {
      "name": "remote events enabled",
      "metrictype": "bool",
      "dimension": "system integrity",
      "severity": 4,
      "scope": "macOS",
      "tags": [
        "CIS Benchmark Level 1,macos_security/sysprefs_rae_disable",
        "ISO 27001/2,Access Control",
        "PCI-DSS,Requirement-6.5",
        "SOC 2,CC-System Integrity"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Remote Apple Events enabled",
          "summary": "Remote Apple Events are enabled. While this could be intentional, we strongly recommend turning it off. It's unnecessary for most users and has been a target for exploits in the recent past."
        },
        {
          "locale": "FR",
          "title": "Événements Apple à distance activés",
          "summary": "Les événements Apple à distance sont activés. Bien que cela puisse être intentionnel, nous vous recommandons fortement de les désactiver. C'est inutile pour la plupart des utilisateurs et cela a été une cible d'attaques dans un passé récent."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "launchctl print-disabled system | grep com.apple.AEServer | grep -E 'enabled|false'",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "link",
        "elevation": "",
        "target": "x-apple.systempreferences:com.apple.sharing?Services_Root=RemoteAppleEvent",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/guide/mac-help/allow-apple-events-from-other-devices-mh14066/mac"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/guide/mac-help/allow-apple-events-from-other-devices-mh14066/mac"
          }
        ]
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "link",
        "elevation": "",
        "target": "x-apple.systempreferences:com.apple.sharing?Services_Root=RemoteAppleEvent",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/guide/mac-help/allow-apple-events-from-other-devices-mh14066/mac"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/guide/mac-help/allow-apple-events-from-other-devices-mh14066/mac"
          }
        ]
      }
    },
    {
      "name": "encrypted disk organizational recovery",
      "metrictype": "bool",
      "dimension": "system integrity",
      "severity": 4,
      "scope": "generic",
      "tags": [
        "Personal Posture"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Corporate disk recovery key",
          "summary": "It seems your computer hard disk has been encrypted by your employer. It means that they could potentially decrypt it if you give the computer back to them. You should suppress that possibility."
        },
        {
          "locale": "FR",
          "title": "Clé d'entreprise de récupération de disque",
          "summary": "Il semble que le disque dur de votre ordinateur ait été crypté par votre employeur. Cela signifie qu'ils pourraient potentiellement le déchiffrer si vous leur rendez l'ordinateur. Vous devriez supprimer cette possibilité."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "fdesetup hasinstitutionalrecoverykey | grep true",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "fdesetup removerecovery -institutional",
        "education": [
          {
            "locale": "EN",
            "class": "html",
            "target": "Removing the institutional recovery key ensures that only you have access to decrypt your disk. Use the command provided with caution and ensure you have an individual recovery key or other means to access your data."
          },
          {
            "locale": "FR",
            "class": "html",
            "target": "La suppression de la clé de récupération institutionnelle garantit que seul vous avez accès pour déchiffrer votre disque. Utilisez la commande fournie avec prudence et assurez-vous d'avoir une clé de récupération individuelle ou d'autres moyens d'accéder à vos données."
          }
        ]
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "fdesetup add -institutional",
        "education": [
          {
            "locale": "EN",
            "class": "html",
            "target": "Re-adding the institutional recovery key allows authorized organizational recovery of your disk. Ensure this is in compliance with your organization's policies."
          },
          {
            "locale": "FR",
            "class": "html",
            "target": "Réajouter la clé de récupération institutionnelle permet une récupération autorisée de votre disque par l'organisation. Assurez-vous que cela est conforme aux politiques de votre organisation."
          }
        ]
      }
    },
    {
      "name": "encrypted disk disabled",
      "metrictype": "bool",
      "dimension": "system services",
      "severity": 4,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1,macos_security/sysprefs_filevault_enforce",
        "ISO 27001/2,Information Security Incident Management",
        "PCI-DSS,Requirement-3.4",
        "SOC 2,CC-Data Protection"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Disk encryption disabled",
          "summary": "Your main storage is not encrypted. While there is a little performance impact by enabling it, we really urge you to set it up. Without that, anyone physically accessing your computer can access your data."
        },
        {
          "locale": "FR",
          "title": "Chiffrement du disque désactivé",
          "summary": "Votre stockage principal n'est pas chiffré. Bien qu'il y ait un petit impact sur les performances en l'activant, nous vous invitons vraiment à le configurer. Sans cela, toute personne accédant physiquement à votre ordinateur peut accéder à vos données."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "system_profiler SPHardwareDataType | grep -q 'Virtual' || fdesetup isactive | grep false",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "link",
        "elevation": "",
        "target": "x-apple.systempreferences:com.apple.preference.security?FileVault",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/guide/mac-help/use-filevault-to-encrypt-your-macs-data-mh11783/mac"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/guide/mac-help/use-filevault-to-encrypt-your-macs-data-mh11783/mac"
          }
        ]
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "link",
        "elevation": "",
        "target": "x-apple.systempreferences:com.apple.preference.security?FileVault",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/guide/mac-help/use-filevault-to-encrypt-your-macs-data-mh11783/mac"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/guide/mac-help/use-filevault-to-encrypt-your-macs-data-mh11783/mac"
          }
        ]
      }
    },
    {
      "name": "unsigned applications allowed",
      "metrictype": "bool",
      "dimension": "applications",
      "severity": 4,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1,macos_security/os_gatekeeper_enable",
        "ISO 27001/2,Information Systems Acquisition, Development, and Maintenance",
        "PCI-DSS,Requirement-6.6",
        "SOC 2,CC-Application Security"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Unsigned applications allowed",
          "summary": "Your computer has been set up to allow unsigned applications to run. This is unusual and dangerous. You should turn this off."
        },
        {
          "locale": "FR",
          "title": "Applications non signées autorisées",
          "summary": "Votre ordinateur a été configuré pour autoriser l'exécution d'applications non signées. C'est inhabituel et dangereux. Vous devriez désactiver cette option."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "spctl --status | grep disabled",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "link",
        "elevation": "",
        "target": "x-apple.systempreferences:com.apple.preference.security?General",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/guide/mac-help/open-a-mac-app-from-an-unidentified-developer-mh40616/mac"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/guide/mac-help/open-a-mac-app-from-an-unidentified-developer-mh40616/mac"
          }
        ]
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "spctl --global-disable",
        "education": [
          {
            "locale": "EN",
            "class": "html",
            "target": "Disabling Gatekeeper allows unsigned applications to run on your macOS system, which can be necessary for certain software not available through the App Store. Be cautious and ensure you trust any unsigned applications you choose to run, as this increases the risk of installing potentially harmful software."
          },
          {
            "locale": "FR",
            "class": "html",
            "target": "Désactiver Gatekeeper permet à des applications non signées de s'exécuter sur votre système macOS, ce qui peut être nécessaire pour certains logiciels non disponibles via l'App Store. Soyez prudent et assurez-vous de faire confiance à toutes les applications non signées que vous choisissez d'exécuter, car cela augmente le risque d'installer des logiciels potentiellement dangereux."
          }
        ]
      }
    },
    {
      "name": "manual system updates",
      "metrictype": "bool",
      "dimension": "system integrity",
      "severity": 4,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1,macos_security/sysprefs_install_macos_updates_enforce",
        "CIS Benchmark Level 1,macos_security/sysprefs_software_update_download_enforce",
        "ISO 27001/2,Information Systems Acquisition, Development, and Maintenance",
        "PCI-DSS,Requirement-6.1",
        "SOC 2,CC-System Maintenance"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Manual system updates",
          "summary": "System updates are manual. You really should turn on automatic system updates to get the latest security fixes for your computer."
        },
        {
          "locale": "FR",
          "title": "Mises à jour système manuelles",
          "summary": "Les mises à jour du système sont manuelles. Vous devriez vraiment activer les mises à jour automatiques du système pour obtenir les derniers correctifs de sécurité pour votre ordinateur."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "globalpreferences",
        "target": "defaults read /Library/Preferences/com.apple.SoftwareUpdate AutomaticallyInstallMacOSUpdates 2>/dev/null | grep -q 1 || echo macosupdate_disabled",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "link",
        "elevation": "",
        "target": "x-apple.systempreferences:com.apple.preferences.softwareupdate",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/en-en/guide/mac-help/mchlpx1065/mac"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/guide/mac-help/mchlpx1065/mac"
          }
        ]
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "link",
        "elevation": "",
        "target": "x-apple.systempreferences:com.apple.preferences.softwareupdate",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/en-en/guide/mac-help/mchlpx1065/mac"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/guide/mac-help/mchlpx1065/mac"
          }
        ]
      }
    },
    {
      "name": "too slow or disabled screensaver lock",
      "metrictype": "bool",
      "dimension": "credentials",
      "severity": 3,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1,macos_security/sysprefs_screensaver_ask_for_password_delay_enforce",
        "ISO 27001/2,Access Control",
        "PCI-DSS,Requirement-8.1.8",
        "SOC 2,CC-Access Control"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Screen lock disabled",
          "summary": "Your computer doesn't have a screensaver enabled with a password. It leaves it open for physical access by anyone. This is very dangerous!"
        },
        {
          "locale": "FR",
          "title": "Écran protégé désactivé",
          "summary": "Votre ordinateur n'a pas d'économiseur d'écran activé avec un mot de passe. Il le laisse ouvert à l'accès physique par n'importe qui. C'est très dangereux !"
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "defaults read com.apple.screensaver askForPasswordDelay | grep -v 0",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "link",
        "elevation": "",
        "target": "x-apple.systempreferences:com.apple.preference.security?General",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/en-en/guide/mac-help/mchlp2270/mac"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/en-en/guide/mac-help/mchlp2270/mac"
          }
        ]
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "link",
        "elevation": "",
        "target": "x-apple.systempreferences:com.apple.preference.security?General",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/en-en/guide/mac-help/mchlp2270/mac"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/guide/mac-help/mchlp2270/mac"
          }
        ]
      }
    },
    {
      "name": "no EPP",
      "metrictype": "bool",
      "dimension": "applications",
      "severity": 4,
      "scope": "generic",
      "tags": [
        "ISO 27001/2,Malware Protection",
        "PCI-DSS,Requirement-5",
        "SOC 2,CC-Malware Protection"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "No antivirus enabled",
          "summary": "You don't have any antivirus installed (MalwareBytes, Sentinel One, BitDefender...). We recommend you to enable one."
        },
        {
          "locale": "FR",
          "title": "Pas d'antivirus activé",
          "summary": "Vous n'avez pas d'antivirus installé (MalwareBytes, Sentinel One, BitDefender...). Nous vous recommandons d'en activer un."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "if ! { pgrep BDLDaemon >/dev/null || pgrep RTProtectionDaemon >/dev/null || sentinelctl version 2>/dev/null | grep -q \"Agent version\"; }; then echo epp_disabled; fi",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "link",
        "elevation": "",
        "target": "https://www.apple.com/fr/macos/security/",
        "education": []
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "link",
        "elevation": "",
        "target": "https://www.apple.com/fr/macos/security/",
        "education": []
      }
    },
    {
      "name": "SIP disabled",
      "metrictype": "bool",
      "dimension": "system integrity",
      "severity": 5,
      "scope": "macOS",
      "tags": [
        "CIS Benchmark Level 1,macos_security/os_sip_enable",
        "ISO 27001/2,System Acquisition, Development and Maintenance",
        "PCI-DSS,Requirement-6.1",
        "SOC 2,CC-System Integrity"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "System Integrity Protection disabled",
          "summary": "System Integrity Protection is a great feature of macOS that prevents any software from changing system files and components. To some extent, it's a 'good enough' antivirus for your Mac. Having it disabled is unusual and dangerous. It should be enabled by default on your Mac. This content will explain a way to enable it again. Bear with me, it's somewhat hard to achieve!"
        },
        {
          "locale": "FR",
          "title": "Protection de l'intégrité du système désactivée",
          "summary": "La Protection de l'Intégrité du Système est une capacité clé de macOS qui empêche tous logiciels de modifier les fichiers et les composants du système. Dans une certaine mesure, c'est un antivirus 'assez bon' pour votre Mac. Le désactiver est inhabituel et dangereux. Il devrait être activé par défaut sur votre Mac. Ce contenu vous expliquera comment l'activer à nouveau. Soyez courageux, c'est un peu difficile à réaliser !"
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "csrutil status | grep disabled",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "html",
        "elevation": "",
        "target": "<p>To enable System Integrity Protection (SIP), follow these steps:</p><ol><li>Restart your Mac.</li><li>Immediately hold down <strong>Command (⌘)</strong> + <strong>R</strong> keys to boot into Recovery Mode.</li><li>Once in Recovery Mode, click on <strong>Utilities</strong> in the menu bar and select <strong>Terminal</strong>.</li><li>In the Terminal window, type <code>csrutil enable</code> and press <strong>Enter</strong>.</li><li>Restart your Mac.</li></ol><p>SIP should now be enabled.</p>",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/en-us/HT204899"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/HT204899"
          }
        ]
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "html",
        "elevation": "",
        "target": "<p>To disable System Integrity Protection (SIP), follow these steps:</p><ol><li>Restart your Mac.</li><li>Immediately hold down <strong>Command (⌘)</strong> + <strong>R</strong> keys to boot into Recovery Mode.</li><li>Once in Recovery Mode, click on <strong>Utilities</strong> in the menu bar and select <strong>Terminal</strong>.</li><li>In the Terminal window, type <code>csrutil disable</code> and press <strong>Enter</strong>.</li><li>Restart your Mac.</li></ol><p>SIP should now be disabled.</p>",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/en-us/HT204899"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/HT204899"
          }
        ]
      }
    },
    {
      "name": "guest account enabled",
      "metrictype": "bool",
      "dimension": "system services",
      "severity": 2,
      "scope": "macOS",
      "tags": [
        "CIS Benchmark Level 1,macos_security/sysprefs_guest_account_disable",
        "ISO 27001/2,Access Control",
        "PCI-DSS,Requirement-8.1.6",
        "SOC 2,CC-Access Control"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Guest account enabled",
          "summary": "Guest account is enabled. This is usually fine, but it's not that easy to limit access to your data. You should disable it."
        },
        {
          "locale": "FR",
          "title": "Compte invité activé",
          "summary": "Le compte invité est activé. C'est généralement bien, mais il n'est pas si facile de limiter l'accès à vos données. Vous devriez le désactiver."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "sysadminctl -guestAccount status 2>&1 | grep enabled",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "link",
        "elevation": "",
        "target": "x-apple.systempreferences:com.apple.preferences.users",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/guide/mac-help/set-up-other-users-on-your-mac-mtusr001/mac"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/guide/mac-help/set-up-other-users-on-your-mac-mtusr001/mac"
          }
        ]
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "link",
        "elevation": "",
        "target": "x-apple.systempreferences:com.apple.preferences.users",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/guide/mac-help/set-up-other-users-on-your-mac-mtusr001/mac"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/guide/mac-help/set-up-other-users-on-your-mac-mtusr001/mac"
          }
        ]
      }
    },
    {
      "name": "root user enabled",
      "metrictype": "bool",
      "dimension": "system integrity",
      "severity": 3,
      "scope": "macOS",
      "tags": [
        "ISO 27001/2,Access Control",
        "PCI-DSS,Requirement-2.3",
        "SOC 2,CC-Access Control"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Root user enabled",
          "summary": "A special system user has been configured on your computer. This is unusual and should be disabled immediately."
        },
        {
          "locale": "FR",
          "title": "Utilisateur root activé",
          "summary": "Un utilisateur système spécial a été configuré sur votre ordinateur. Ceci est inhabituel et doit être désactivé immédiatement."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "dscl . -read /Users/root Password | grep '\\*\\*'",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "html",
        "elevation": "",
        "target": "<p>To disable the root user on macOS, follow these steps:</p><ol><li>Click on the Apple menu and select <strong>System Preferences</strong>.</li><li>Click on <strong>Users & Groups</strong>.</li><li>Click the lock icon and enter your administrator name and password.</li><li>Click <strong>Login Options</strong>.</li><li>Click <strong>Join</strong> (or <strong>Edit</strong>).</li><li>Click <strong>Open Directory Utility</strong>.</li><li>Click the lock icon in the Directory Utility window and enter your administrator credentials.</li><li>From the menu bar, select <strong>Edit</strong> &gt; <strong>Disable Root User</strong>.</li></ol>",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/HT204012"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/HT204012"
          }
        ]
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "html",
        "elevation": "",
        "target": "<p>To enable the root user on macOS, follow these steps:</p><ol><li>Click on the Apple menu and select <strong>System Preferences</strong>.</li><li>Click on <strong>Users & Groups</strong>.</li><li>Click the lock icon and enter your administrator name and password.</li><li>Click <strong>Login Options</strong>.</li><li>Click <strong>Join</strong> (or <strong>Edit</strong>).</li><li>Click <strong>Open Directory Utility</strong>.</li><li>Click the lock icon in the Directory Utility window and enter your administrator credentials.</li><li>From the menu bar, select <strong>Edit</strong> &gt; <strong>Enable Root User</strong>.</li></ol>",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/HT204012"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/HT204012"
          }
        ]
      }
    },
    {
      "name": "unprotected system wide changes",
      "metrictype": "bool",
      "dimension": "system integrity",
      "severity": 3,
      "scope": "macOS",
      "tags": [
        "CIS Benchmark Level 1,macos_security/sysprefs_system_wide_preferences_configure",
        "ISO 27001/2,Access Control",
        "PCI-DSS,Requirement-2.2",
        "SOC 2,CC-Access Control"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Unprotected system changes",
          "summary": "Your computer system settings can be modified by any users. You should restrict it."
        },
        {
          "locale": "FR",
          "title": "Changement de paramètres système non protégés",
          "summary": "Les paramètres de votre système informatique peuvent être modifiés par tous les utilisateurs. Vous devriez le restreindre."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "security authorizationdb read system.preferences 2> /dev/null | grep -A1 shared | grep true",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "html",
        "elevation": "",
        "target": "<p>To restrict system-wide changes, follow these steps:</p><ol><li>Open <strong>Terminal</strong>.</li><li>Run the following command:<br><code>sudo security authorizationdb write system.preferences authenticate-session-owner-or-admin</code></li><li>Enter your administrator password when prompted.</li></ol><p>This will require authentication for system-wide preference changes.</p>",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/en-en/guide/mac-help/mh40595"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/guide/mac-help/mh40595"
          }
        ]
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "html",
        "elevation": "",
        "target": "<p>To allow system-wide changes without authentication, follow these steps:</p><ol><li>Open <strong>Terminal</strong>.</li><li>Run the following command:<br><code>sudo security authorizationdb write system.preferences allow</code></li><li>Enter your administrator password when prompted.</li></ol><p>This will remove the authentication requirement for system-wide preference changes.</p>",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.apple.com/en-en/guide/mac-help/mh40595"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.apple.com/fr-fr/guide/mac-help/mh40595"
          }
        ]
      }
    },
    {
      "name": "pwned",
      "metrictype": "bool",
      "dimension": "credentials",
      "severity": 1,
      "scope": "generic",
      "tags": [
        "ISO 27001/2,Information Security Incident Management",
        "PCI-DSS,Requirement-12.10",
        "SOC 2,CC-Incident Response",
        "Personal Posture"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Potentially compromised email address",
          "summary": "Check if your email address might have recently appeared in a data breach."
        },
        {
          "locale": "FR",
          "title": "Adresse e-mail potentiellement compromise",
          "summary": "Vérifiez si votre adresse e-mail est peut-être apparue récemment dans une fuite de données."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "internal",
        "elevation": "user",
        "target": "pwned -i 365",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "internal",
        "elevation": "",
        "target": "digitalidentity_manager",
        "education": [
          {
            "locale": "EN",
            "class": "html",
            "target": "<p>To verify and mitigate the impact of a breach associated with your email, follow these steps:</p><ul><li>Navigate to the 'Identity' tab.</li><li>Enter your email address in the provided field.</li><li>Review the list of breaches associated with your email.</li><li>Select a breach to view detailed information and perform an AI-driven analysis.</li><li>Based on the analysis, decide whether to dismiss the breach or take further action if it's significant.</li><li>Once all threats are addressed, this alert will be marked as inactive.</li></ul>"
          },
          {
            "locale": "FR",
            "class": "html",
            "target": "<p>Pour vérifier et atténuer l'impact d'une fuite de données associée à votre email, suivez ces étapes :</p><ul><li>Allez dans l'onglet 'Identité'.</li><li>Entrez votre adresse e-mail dans le champ prévu.</li><li>Examinez la liste des fuites associées à votre email.</li><li>Sélectionnez une fuite pour voir les informations détaillées et effectuer une analyse assistée par IA.</li><li>En fonction de l'analyse, décidez de rejeter la fuite ou de prendre des mesures supplémentaires si elle est significative.</li><li>Une fois toutes les menaces traitées, cette alerte sera marquée comme inactive.</li></ul>"
          }
        ]
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "",
        "elevation": "",
        "target": "",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://haveibeenpwned.com/"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://www.futura-sciences.com/tech/actualites/internet-voici-savoir-si-vos-donnees-personnelles-internet-ont-ete-piratees-103095/"
          }
        ]
      }
    },
    {
      "name": "lanscan",
      "metrictype": "bool",
      "dimension": "network",
      "severity": 1,
      "scope": "generic",
      "tags": [
        "ISO 27001/2,Information Security Incident Management",
        "PCI-DSS,Requirement-12.10",
        "SOC 2,CC-Incident Response",
        "Personal Posture"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Unverified or unsafe network environment",
          "summary": "The network you are connected to is not a known one or it contains unsafe devices. If you are allowed to scan this network, go to the network tab and verify the presence of potentially dangerous devices."
        },
        {
          "locale": "FR",
          "title": "Environnement réseau non vérifié ou non sécurisé",
          "summary": "Le réseau auquel vous êtes connecté n'est pas connu ou contient des appareils non sécurisés. Si vous êtes autorisé à scanner ce réseau, allez dans l'onglet réseau et vérifiez la présence de périphériques potentiellement dangereux."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "internal",
        "elevation": "user",
        "target": "lanscan",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "internal",
        "elevation": "",
        "target": "network_manager",
        "education": [
          {
            "locale": "EN",
            "class": "html",
            "target": "<p>Scan your network to identify all connected devices and assess potential threats by following these steps:</p><ul><li>Navigate to the 'Network' tab.</li><li>Devices of critical importance are marked with yellow for medium criticality and red for high criticality.</li><li>Select a critical device.</li><li>Assess each port's criticality by reading the associated CVEs and analyzing potential issues with AI.</li><li>If a port is determined to be safe, mark it as verified.</li></ul><p>Once all devices are deemed safe, this threat will be marked as inactive.</p>"
          },
          {
            "locale": "FR",
            "class": "html",
            "target": "<p>Scannez votre réseau pour identifier tous les appareils connectés et évaluer les menaces potentielles en suivant ces étapes :</p><ul><li>Allez dans l'onglet 'Réseau'.</li><li>Les appareils de grande importance sont marqués en jaune pour une criticité moyenne et en rouge pour une criticité élevée.</li><li>Sélectionnez un appareil critique.</li><li>Évaluez la criticité de chaque port en lisant les CVE associés et en analysant les problèmes potentiels avec l'IA.</li><li>Si un port est déterminé comme sûr, marquez-le comme vérifié.</li></ul><p>Une fois que tous les appareils sont considérés comme sûrs, cette menace sera marquée comme inactive.</p>"
          }
        ]
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "internal",
        "elevation": "",
        "target": "network_manager",
        "education": [
          {
            "locale": "EN",
            "class": "html",
            "target": "<p>Scan your network to identify all connected devices and assess potential threats by following these steps:</p><ul><li>Navigate to the 'Network' tab.</li><li>Devices of critical importance are marked with yellow for medium criticality and red for high criticality.</li><li>Select a critical device.</li><li>Assess each port's criticality by reading the associated CVEs and analyzing potential issues with AI.</li><li>If a port is determined to be safe, mark it as verified.</li></ul><p>Once all devices are deemed safe, this threat will be marked as inactive.</p>"
          },
          {
            "locale": "FR",
            "class": "html",
            "target": "<p>Scannez votre réseau pour identifier tous les appareils connectés et évaluer les menaces potentielles en suivant ces étapes :</p><ul><li>Allez dans l'onglet 'Réseau'.</li><li>Les appareils de grande importance sont marqués en jaune pour une criticité moyenne et en rouge pour une criticité élevée.</li><li>Sélectionnez un appareil critique.</li><li>Évaluez la criticité de chaque port en lisant les CVE associés et en analysant les problèmes potentiels avec l'IA.</li><li>Si un port est déterminé comme sûr, marquez-le comme vérifié.</li></ul><p>Une fois que tous les appareils sont considérés comme sûrs, cette menace sera marquée comme inactive.</p>"
          }
        ]
      }
    },
    {
      "name": "latest os",
      "metrictype": "bool",
      "dimension": "system integrity",
      "severity": 2,
      "scope": "generic",
      "tags": [
        "ISO 27001/2,System Acquisition, Development and Maintenance",
        "PCI-DSS,Requirement-6.2",
        "SOC 2,CC-System Maintenance"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Your OS is not up to date",
          "summary": "Your operating system is not up to date, please proceed to upgrade to get the latest security patches."
        },
        {
          "locale": "FR",
          "title": "Votre OS n'est pas à jour",
          "summary": "Votre système d'exploitation n'est pas à jour, veuillez procéder à sa mise à niveau afin d'obtenir les derniers correctifs de sécurité."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "globalpreferences",
        "target": "defaults read /Library/Preferences/com.apple.SoftwareUpdate.plist | grep macOS",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "link",
        "elevation": "",
        "target": "x-apple.systempreferences:com.apple.preferences.softwareupdate",
        "education": [
          {
            "locale": "EN",
            "class": "html",
            "target": "To update your macOS, press the button to access the relevant system settings. Click 'Update Now' or 'Upgrade Now' if an update is available and follow the prompts to install the latest version."
          },
          {
            "locale": "FR",
            "class": "html",
            "target": "Pour mettre à jour votre macOS, appuyez sur le bouton pour accèder au paramètres systèmes correspondants. Cliquez sur 'Mettre à jour maintenant' ou 'Mettre à niveau maintenant' si une mise à jour est disponible et suivez les instructions pour installer la dernière version."
          }
        ]
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "",
        "elevation": "",
        "target": "",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://www.macworld.com/article/673171/how-to-install-older-versions-of-macos-or-os-x.html"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://www.techadvisor.com/article/1490855/comment-installer-ancienne-version-macos.html"
          }
        ]
      }
    },
    {
      "name": "Chrome not uptodate",
      "metrictype": "bool",
      "dimension": "applications",
      "severity": 3,
      "scope": "generic",
      "tags": [
        "ISO 27001/2,Application Security",
        "PCI-DSS,Requirement-6",
        "SOC 2,CC-System Operations"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Chrome browser not up to date",
          "summary": "Your Google Chrome browser is not up to date. Running the latest version ensures you have the latest security features and performance improvements."
        },
        {
          "locale": "FR",
          "title": "Navigateur Chrome non à jour",
          "summary": "Votre navigateur Google Chrome n'est pas à jour. Exécuter la dernière version garantit que vous disposez des dernières fonctionnalités de sécurité et des améliorations de performance."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "if defaults read /Applications/Google\\ Chrome.app/Contents/Info.plist CFBundleShortVersionString &>/dev/null; then latest_version=$(curl -s \"https://formulae.brew.sh/api/cask/google-chrome.json\" | awk -F'[\"]' '{for(i=1;i<=NF;i++) if ($i==\"version\") {print $(i+2); exit}}'); local_version=$(defaults read /Applications/Google\\ Chrome.app/Contents/Info.plist CFBundleShortVersionString); if [ \"$latest_version\" = \"$local_version\" ]; then echo \"\"; else echo \"Chrome is not up to date (Installed: $local_version, Latest: $latest_version)\"; fi; else echo \"\"; fi",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "",
        "elevation": "",
        "target": "",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.google.com/chrome/answer/95414"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.google.com/chrome/answer/95414?hl=fr"
          }
        ]
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "",
        "elevation": "",
        "target": "",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.google.com/chrome/answer/95414"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.google.com/chrome/answer/95414?hl=fr"
          }
        ]
      }
    }
  ]
}