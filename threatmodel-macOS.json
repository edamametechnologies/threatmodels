{
  "name": "threat model macOS",
  "extends": "none",
  "date": "June 14th 2023",
  "signature": "1281887ecad50ca8e7c5c29f8cf528bb33c0a7bae4d3c57ef2f8d2dd081814f9",
  "metrics": [
    {
      "name": "edamame helper disabled",
      "metrictype": "bool",
      "dimension": "system services",
      "severity": 5,
      "scope": "generic",
      "tags": [],
      "description": [
        {
          "locale": "EN",
          "title": "Edamame helper inactive",
          "summary": "Edamame's Helper software is not running or requires an update. It's required for maximum Security Score analysis."
        },
        {
          "locale": "FR",
          "title": "Edamame Helper inactif",
          "summary": "Le logiciel d'assistance d'Edamame n'est pas en cours d'ex\u00e9cution ou a besoin d'\u00eatre mis \u00e0 jour. Il est requis pour une analyse compl\u00e8te du score de s\u00e9curit\u00e9."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "ps -ef | grep edamame_helper | grep -v grep > /dev/null || echo nohelper",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "installer",
        "elevation": "user",
        "target": "https://edamame-helper.s3.eu-west-1.amazonaws.com/macos/",
        "education": []
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "/Library/Application\\ Support/Edamame/Edamame-Helper/uninstall.sh",
        "education": []
      }
    },
    {
      "name": "MDM profiles",
      "metrictype": "bool",
      "dimension": "system integrity",
      "severity": 5,
      "scope": "generic",
      "tags": [],
      "description": [
        {
          "locale": "EN",
          "title": "MDM profiles installed",
          "summary": "You have one or more Mobile Device Management (MDM) profiles installed on your computer. This means that your computer is or can be remotely administered by a 3rd party. If this is your personal computer, this is a grave threat and the profiles should be removed."
        },
        {
          "locale": "FR",
          "title": "Profils MDM install\u00e9s",
          "summary": "Un ou plusieurs profils de gestion des appareils mobiles (MDM) sont install\u00e9s sur votre ordinateur. Cela signifie que votre ordinateur est, ou peut \u00eatre, administr\u00e9 \u00e0 distance par un tiers. S'il s'agit de votre ordinateur personnel, il s'agit d'une grave menace et les profils doivent \u00eatre supprim\u00e9s."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "profiles -P | grep profileIdentifier",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "profiles remove -all -forced",
        "education": []
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "",
        "elevation": "",
        "target": "",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://en.wikipedia.org/wiki/Mobile_device_management"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://fr.wikipedia.org/wiki/Mobile_device_management"
          }
        ]
      }
    },
    {
      "name": "JAMF remote admin",
      "metrictype": "bool",
      "dimension": "system integrity",
      "severity": 5,
      "scope": "macOS",
      "tags": [],
      "description": [
        {
          "locale": "EN",
          "title": "JAMF remote administration enabled",
          "summary": "Your computer is or can be remotely administered by a 3rd party using the JAMF MDM framework. If this is your personal computer, this is a grave threat and JAMF should be removed."
        },
        {
          "locale": "FR",
          "title": "Administration \u00e0 distance JAMF install\u00e9e",
          "summary": "Votre ordinateur est, ou peut \u00eatre, administr\u00e9 \u00e0 distance par un tiers \u00e0 l'aide du framework JAMF MDM. S'il s'agit de votre ordinateur personnel, il s'agit d'une grave menace et JAMF doit \u00eatre supprim\u00e9."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "pgrep jamf",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "jamf removeFramework",
        "education": []
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "",
        "elevation": "",
        "target": "",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://www.jamf.com/en"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://www.jamf.com/fr"
          }
        ]
      }
    },
    {
      "name": "WOL enabled",
      "metrictype": "bool",
      "dimension": "network",
      "severity": 1,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1",
        "macos_security/sysprefs_wake_network_access_disable"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Wake On LAN enabled",
          "summary": "Wake on LAN is a feature that can wake up your computer automatically when something is attempting to connect to it. This is not something you need in most cases and it can allow an attacker to connect to your computer at any time."
        },
        {
          "locale": "FR",
          "title": "Wake On LAN activ\u00e9",
          "summary": "Wake on LAN est une fonctionnalit\u00e9 qui peut r\u00e9veiller automatiquement votre ordinateur lorsque quelque chose tente de s'y connecter. Ce n'est pas quelque chose dont vous avez besoin dans la plupart des cas et cela peut permettre \u00e0 un malfrat de se connecter \u00e0 votre ordinateur \u00e0 tout moment."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "systemsetup getwakeonnetworkaccess | grep -v Off",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "systemsetup -setwakeonnetworkaccess off",
        "education": []
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "systemsetup -setwakeonnetworkaccess on",
        "education": []
      }
    },
    {
      "name": "manual store application updates",
      "metrictype": "bool",
      "dimension": "applications",
      "severity": 3,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1",
        "macos_security/sysprefs_software_update_app_update_enforce"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Manual Appstore updates",
          "summary": "Applications are constantly updated to fix potential security issues. It's your best interest to get updates as soon as you can through automatic updates."
        },
        {
          "locale": "FR",
          "title": "Mises \u00e0 jour Appstore manuelles",
          "summary": "Les applications sont constamment mises \u00e0 jour pour r\u00e9soudre les probl\u00e8mes de s\u00e9curit\u00e9 potentiels. Il est dans votre int\u00e9r\u00eat d'obtenir les mises \u00e0 jour d\u00e8s que possible gr\u00e2ce aux mises \u00e0 jour automatiques."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "defaults read /Library/Preferences/com.apple.commerce.plist AutoUpdate 2>&1 | grep -v 1",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "defaults write /Library/Preferences/com.apple.commerce.plist AutoUpdate -bool true; defaults write /Library/Preferences/com.apple.SoftwareUpdate AutomaticallyInstallAppUpdates -bool true",
        "education": []
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "defaults write /Library/Preferences/com.apple.commerce.plist AutoUpdate -bool false; defaults write /Library/Preferences/com.apple.SoftwareUpdate AutomaticallyInstallAppUpdates -bool false",
        "education": []
      }
    },
    {
      "name": "local firewall disabled",
      "metrictype": "bool",
      "dimension": "network",
      "severity": 2,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1",
        "macos_security/sysprefs_firewall_enable"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Local firewall disabled",
          "summary": "Your local firewall is disabled. This is fine in a trusted environment but dangerous if you happened to connect to public networks. You should turn it on by default."
        },
        {
          "locale": "FR",
          "title": "Pare-feu local d\u00e9sactiv\u00e9",
          "summary": "Votre pare-feu local est d\u00e9sactiv\u00e9. C'est bien dans un environnement de confiance mais dangereux si vous vous connectez \u00e0 des r\u00e9seaux publics. Vous devriez l'activer par d\u00e9faut."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "defaults read /Library/Preferences/com.apple.alf globalstate | grep 0",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "defaults write /Library/Preferences/com.apple.alf globalstate -int 2",
        "education": []
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "defaults write /Library/Preferences/com.apple.alf globalstate -int 0",
        "education": []
      }
    },
    {
      "name": "automatic login enabled",
      "metrictype": "bool",
      "dimension": "credentials",
      "severity": 4,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1",
        "macos_security/sysprefs_automatic_login_disable"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Automatic login enabled",
          "summary": "Automatic login could appear as very handy but in fact it's a major security threat: it allows anyone to access your data without knowing your password."
        },
        {
          "locale": "FR",
          "title": "Login automatique activ\u00e9",
          "summary": "La connexion automatique peut sembler tr\u00e8s pratique mais en fait c'est une menace majeure pour la s\u00e9curit\u00e9 : elle permet \u00e0 n'importe qui d'acc\u00e9der \u00e0 vos donn\u00e9es sans conna\u00eetre votre mot de passe."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "defaults read /Library/Preferences/com.apple.loginwindow | grep autoLoginUser",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "defaults delete /Library/Preferences/com.apple.loginwindow autoLoginUser",
        "education": []
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "",
        "elevation": "",
        "target": "",
        "education": [
          {
            "locale": "EN",
            "class": "youtube",
            "target": "https://www.youtube.com/watch?v=G89On8uvQuQ"
          }
        ]
      }
    },
    {
      "name": "remote login enabled",
      "metrictype": "bool",
      "dimension": "system integrity",
      "severity": 4,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1",
        "macos_security/sysprefs_ssh_disable"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Remote login enabled",
          "summary": "Remote login is enabled. This is not necessary unless your are an IT professional. This is unusual and dangerous for most users."
        },
        {
          "locale": "FR",
          "title": "Acc\u00e8s \u00e0 distance activ\u00e9",
          "summary": "L'acc\u00e8s \u00e0 distance est activ\u00e9e. Ce n'est pas n\u00e9cessaire sauf si vous \u00eates un professionnel de l'informatique. Ceci est inhabituel et dangereux pour la plupart des utilisateurs."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "systemsetup -getremotelogin | grep On",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "fulldisk",
        "target": "echo yes | systemsetup -setremotelogin off",
        "education": []
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "fulldisk",
        "target": "systemsetup -setremotelogin on",
        "education": []
      }
    },
    {
      "name": "remote desktop enabled",
      "metrictype": "bool",
      "dimension": "system integrity",
      "severity": 4,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1",
        "macos_security/sysprefs_remote_management_disable"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Remote desktop enabled",
          "summary": "Remote desktop is enabled. This is not necessary unless your are an IT professional. This is unusual and dangerous for most users."
        },
        {
          "locale": "FR",
          "title": "Bureau \u00e0 distance activ\u00e9",
          "summary": "La connexion au bureau \u00e0 distance est activ\u00e9e. Ce n'est pas n\u00e9cessaire sauf si vous \u00eates un professionnel de l'informatique. Ceci est inhabituel et dangereux pour la plupart des utilisateurs."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "pgrep ARDAgent",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "/System/Library/CoreServices/RemoteManagement/ARDAgent.app/Contents/Resources/kickstart -deactivate -configure -access -off",
        "education": []
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "/System/Library/CoreServices/RemoteManagement/ARDAgent.app/Contents/Resources/kickstart -restart -agent",
        "education": []
      }
    },
    {
      "name": "file sharing enabled",
      "metrictype": "bool",
      "dimension": "system services",
      "severity": 4,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1",
        "macos_security/sysprefs_smbd_disable"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "File sharing enabled",
          "summary": "File sharing is enabled. While this could be intentional we strongly recommend to turn it off. It's not that easy to configure and can expose your data to unwanted people."
        },
        {
          "locale": "FR",
          "title": "Partage de fichiers activ\u00e9",
          "summary": "Le partage de fichiers est activ\u00e9. Bien que cela puisse \u00eatre intentionnel, nous vous recommandons fortement de le d\u00e9sactiver. Ce n'est pas si facile \u00e0 configurer et cela peut exposer vos donn\u00e9es \u00e0 des personnes ind\u00e9sirables."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "pgrep smbd",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "launchctl unload -w /System/Library/LaunchDaemons/com.apple.smbd.plist",
        "education": []
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "launchctl load -w /System/Library/LaunchDaemons/com.apple.smbd.plist; defaults write /Library/Preferences/SystemConfiguration/com.apple.smb.server.plist EnabledServices -array disk",
        "education": []
      }
    },
    {
      "name": "remote events enabled",
      "metrictype": "bool",
      "dimension": "system integrity",
      "severity": 4,
      "scope": "macOS",
      "tags": [
        "CIS Benchmark Level 1",
        "macos_security/sysprefs_rae_disable"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Remote events enabled",
          "summary": "Remote events are enabled. While this could be intentional we strongly recommend to turn it off. It's unnecessary for most users and has been a target for exploit in the recent past."
        },
        {
          "locale": "FR",
          "title": "\u00c9v\u00e9nements \u00e0 distance activ\u00e9s",
          "summary": "Les \u00e9v\u00e9nements \u00e0 distance sont activ\u00e9s. Bien que cela puisse \u00eatre intentionnel, nous vous recommandons fortement de les d\u00e9sactiver. C'est inutile pour la plupart des utilisateurs et cela a \u00e9t\u00e9 une cible d'attaques dans un pass\u00e9 r\u00e9cent."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "launchctl print-disabled system | grep com.apple.AEServer | grep false",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "fulldisk",
        "target": "systemsetup -setremoteappleevents off",
        "education": []
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "fulldisk",
        "target": "systemsetup -setremoteappleevents on",
        "education": []
      }
    },
    {
      "name": "encrypted disk organizational recovery",
      "metrictype": "bool",
      "dimension": "system integrity",
      "severity": 4,
      "scope": "generic",
      "tags": [],
      "description": [
        {
          "locale": "EN",
          "title": "Corporate disk recovery key",
          "summary": "It seems your computer hard disk has been encrypted by your employer. It means that they could potentially decrypt it if you give the computer back to them. You should suppress that possibility."
        },
        {
          "locale": "FR",
          "title": "Cl\u00e9 d'entreprise de r\u00e9cup\u00e9ration de disque",
          "summary": "Il semble que le disque dur de votre ordinateur ait \u00e9t\u00e9 crypt\u00e9 par votre employeur. Cela signifie qu'ils pourraient potentiellement le d\u00e9chiffrer si vous leur rendez l'ordinateur. Vous devriez supprimer cette possibilit\u00e9."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "fdesetup hasinstitutionalrecoverykey | grep true",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "",
        "elevation": "",
        "target": "",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://derflounder.wordpress.com/2019/07/03/managing-macos-mojaves-filevault-2-with-fdesetup/"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://derflounder-wordpress-com.translate.goog/2019/07/03/managing-macos-mojaves-filevault-2-with-fdesetup/?_x_tr_sl=auto&_x_tr_tl=fr&_x_tr_hl=en&_x_tr_pto=wapp"
          }
        ]
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "",
        "elevation": "",
        "target": "",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://derflounder.wordpress.com/2019/07/03/managing-macos-mojaves-filevault-2-with-fdesetup/"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://derflounder-wordpress-com.translate.goog/2019/07/03/managing-macos-mojaves-filevault-2-with-fdesetup/?_x_tr_sl=auto&_x_tr_tl=fr&_x_tr_hl=en&_x_tr_pto=wapp"
          }
        ]
      }
    },
    {
      "name": "encrypted disk disabled",
      "metrictype": "bool",
      "dimension": "system services",
      "severity": 4,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1",
        "macos_security/sysprefs_filevault_enforce"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Disk encryption disabled",
          "summary": "Your main storage is not encrypted. While there is a little performance impact by enabling it, we really urge you to set it up. Without that anyone physically accessing your computer can access your data."
        },
        {
          "locale": "FR",
          "title": "Encryption du disque d\u00e9sactiv\u00e9e",
          "summary": "Votre stockage principal n'est pas crypt\u00e9. Bien qu'il y ait un petit impact sur les performances en l'activant, nous vous invitons vraiment \u00e0 le configurer. Sans cela, toute personne acc\u00e9dant physiquement \u00e0 votre ordinateur peut acc\u00e9der \u00e0 vos donn\u00e9es."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "fdesetup isactive | grep false",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "",
        "elevation": "",
        "target": "",
        "education": [
          {
            "locale": "EN",
            "class": "youtube",
            "target": "https://www.youtube.com/watch?v=ETgLlx3Npqg"
          },
          {
            "locale": "FR",
            "class": "youtube",
            "target": "https://www.youtube.com/watch?v=Ovr9nyIagTY"
          }
        ]
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "",
        "elevation": "",
        "target": "",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://www.youtube.com/watch?v=ETgLlx3Npqg"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://www.youtube.com/watch?v=Ovr9nyIagTY"
          }
        ]
      }
    },
    {
      "name": "unsigned applications allowed",
      "metrictype": "bool",
      "dimension": "applications",
      "severity": 4,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1",
        "macos_security/os_gatekeeper_enable"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Unsigned applications allowed",
          "summary": "Your computer has been setup to allow unsigned applications to run. This is unusual and dangerous. You should turn this off."
        },
        {
          "locale": "FR",
          "title": "Applications non sign\u00e9es autoris\u00e9es",
          "summary": "Votre ordinateur a \u00e9t\u00e9 configur\u00e9 pour autoriser l'ex\u00e9cution d'applications non sign\u00e9es. C'est inhabituel et dangereux. Vous devriez d\u00e9sactiver cette option."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "spctl --status | grep disabled",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "spctl --global-enable",
        "education": []
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "spctl --global-disable",
        "education": []
      }
    },
    {
      "name": "manual system updates",
      "metrictype": "bool",
      "dimension": "system integrity",
      "severity": 4,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1",
        "macos_security/sysprefs_install_macos_updates_enforce",
        "macos_security/sysprefs_software_update_download_enforce"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Manual system updates",
          "summary": "System updates are manual. Your really should turn on automatic system updates to get the latest security fixes for your computer."
        },
        {
          "locale": "FR",
          "title": "Mises \u00e0 jour syst\u00e8me manuelles",
          "summary": "Les mises \u00e0 jour du syst\u00e8me sont manuelles. Vous devriez vraiment activer les mises \u00e0 jour automatiques du syst\u00e8me pour obtenir les derniers correctifs de s\u00e9curit\u00e9 pour votre ordinateur."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "defaults read /Library/Preferences/com.apple.SoftwareUpdate AutomaticallyInstallMacOSUpdates 2>&1 | grep -v 1",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "defaults write /Library/Preferences/com.apple.SoftwareUpdate AutomaticCheckEnabled -bool true; defaults write /Library/Preferences/com.apple.SoftwareUpdate AutomaticDownload -bool true; defaults write /Library/Preferences/com.apple.SoftwareUpdate AutomaticallyInstallMacOSUpdates -bool true; defaults write /Library/Preferences/com.apple.SoftwareUpdate CriticalUpdateInstall -bool true; defaults write /Library/Preferences/com.apple.SoftwareUpdate ConfigDataInstall -bool true; softwareupdate --schedule on",
        "education": []
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "defaults write /Library/Preferences/com.apple.SoftwareUpdate AutomaticCheckEnabled -bool false; defaults write /Library/Preferences/com.apple.SoftwareUpdate AutomaticDownload -bool false; defaults write /Library/Preferences/com.apple.SoftwareUpdate AutomaticallyInstallMacOSUpdates -bool false; defaults write /Library/Preferences/com.apple.SoftwareUpdate CriticalUpdateInstall -bool false; defaults write /Library/Preferences/com.apple.SoftwareUpdate ConfigDataInstall -bool false; softwareupdate --schedule off",
        "education": []
      }
    },
    {
      "name": "response to ping enabled",
      "metrictype": "bool",
      "dimension": "network",
      "severity": 3,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1",
        "macos_security/sysprefs_firewall_stealth_mode_enable"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Response to ping enabled",
          "summary": "Your computer will respond if anything on the network is trying to check its presence. This can be very bad and allow anyone to check your presence and possibly attack your computer."
        },
        {
          "locale": "FR",
          "title": "R\u00e9ponse au ping activ\u00e9e",
          "summary": "Votre ordinateur r\u00e9pondra si quelque chose essaie de v\u00e9rifier sa pr\u00e9sence. Cela peut \u00eatre tr\u00e8s mauvais et permettre \u00e0 quiconque de v\u00e9rifier votre pr\u00e9sence sur un r\u00e9seau et \u00e9ventuellement d'attaquer votre ordinateur...."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "/usr/libexec/ApplicationFirewall/socketfilterfw --getstealthmode | grep disabled",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "/usr/libexec/ApplicationFirewall/socketfilterfw --setstealthmode on",
        "education": []
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "/usr/libexec/ApplicationFirewall/socketfilterfw --setstealthmode off",
        "education": []
      }
    },
    {
      "name": "too slow or disabled screensaver lock",
      "metrictype": "bool",
      "dimension": "credentials",
      "severity": 3,
      "scope": "generic",
      "tags": [
        "CIS Benchmark Level 1",
        "macos_security/sysprefs_screensaver_ask_for_password_delay_enforce"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Screen lock disabled",
          "summary": "Your computer doesn't have a screensaver enabled with a password. It leaves it open for phsyical access by anyone. This is very dangerous!"
        },
        {
          "locale": "FR",
          "title": "Ecran prot\u00e9g\u00e9 d\u00e9sactiv\u00e9",
          "summary": "Votre ordinateur n'a pas d'\u00e9conomiseur d'\u00e9cran activ\u00e9 avec un mot de passe. Il le laisse ouvert \u00e0 l'acc\u00e8s physique par n'importe qui. C'est tr\u00e8s dangereux !"
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "sysadminctl -screenLock status 2>&1 | grep off",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "",
        "elevation": "",
        "target": "",
        "education": [
          {
            "locale": "EN",
            "class": "youtube",
            "target": "https://www.youtube.com/watch?v=C6of13nZTpM"
          },
          {
            "locale": "FR",
            "class": "youtube",
            "target": "https://www.youtube.com/watch?v=C6of13nZTpM"
          }
        ]
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "",
        "elevation": "",
        "target": "",
        "education": [
          {
            "locale": "EN",
            "class": "youtube",
            "target": "https://www.youtube.com/watch?v=C6of13nZTpM"
          },
          {
            "locale": "FR",
            "class": "youtube",
            "target": "https://www.youtube.com/watch?v=C6of13nZTpM"
          }
        ]
      }
    },
    {
      "name": "installed EPP",
      "metrictype": "bool",
      "dimension": "applications",
      "severity": 4,
      "scope": "generic",
      "tags": [],
      "description": [
        {
          "locale": "EN",
          "title": "No antivirus installed",
          "summary": "You don't have any antivirus installed. We recommend you to install one."
        },
        {
          "locale": "FR",
          "title": "Pas d'antivirus install\u00e9",
          "summary": "Vous n'avez pas d'antivirus install\u00e9. Nous vous recommandons d'en installer un."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "pgrep RTProtectionDaemon >/dev/null || echo noepp",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "",
        "elevation": "",
        "target": "",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://www.malwarebytes.com/"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://www.malwarebytes.com/"
          }
        ]
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "",
        "elevation": "",
        "target": "",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://support.malwarebytes.com/hc/en-us/articles/360039023473-Uninstall-and-reinstall-Malwarebytes-using-the-Malwarebytes-Support-Tool"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://support.malwarebytes.com/hc/en-us/articles/360039023473-Uninstall-and-reinstall-Malwarebytes-using-the-Malwarebytes-Support-Tool"
          }
        ]
      }
    },
    {
      "name": "SIP disabled",
      "metrictype": "bool",
      "dimension": "system integrity",
      "severity": 5,
      "scope": "macOS",
      "tags": [
        "CIS Benchmark Level 1",
        "macos_security/os_sip_enable"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "System Integrity Protection disabled",
          "summary": "System Integrity Protection is a great ability of macOS that prevents any software to change system files and components. To some extent it's a \"good enough\" antivirus for your Mac. Having it disabled is... unusual and dangerous. It should be enabled by default on your Mac. This content will explain a way to enable it again. Bear with me .. it's somewhat hard to achieve!"
        },
        {
          "locale": "FR",
          "title": "Protection d'int\u00e9grit\u00e9 syst\u00e8me d\u00e9sactiv\u00e9e",
          "summary": "La Protection de l'Int\u00e9grit\u00e9 du Syst\u00e8me est une capacit\u00e9 cl\u00e9 de macOS qui emp\u00eache tous logiciels de modifier les fichiers et les composants du syst\u00e8me. Dans une certaine mesure, c'est un antivirus \"assez bon\" pour votre Mac. Le d\u00e9sactiver est... inhabituel et dangereux. Il devrait \u00eatre activ\u00e9 par d\u00e9faut sur votre Mac. Ce contenu vous expliquera comment l'activer \u00e0 nouveau. Soyez courageux... c'est un peu difficile \u00e0 r\u00e9aliser !"
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "csrutil status | grep disabled",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "",
        "elevation": "",
        "target": "",
        "education": [
          {
            "locale": "EN",
            "class": "youtube",
            "target": "https://www.youtube.com/watch?v=Fx_1OPFzu88"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://www.remosoftware.com/info/fr/comment-activer-ou-desactiver-la-protection-de-lintegrite-du-systeme-mac/"
          }
        ]
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "",
        "elevation": "",
        "target": "",
        "education": [
          {
            "locale": "EN",
            "class": "youtube",
            "target": "https://www.youtube.com/watch?v=StAn0ZHiXTc"
          }
        ]
      }
    },
    {
      "name": "guest account enabled",
      "metrictype": "bool",
      "dimension": "system services",
      "severity": 2,
      "scope": "macOS",
      "tags": [
        "CIS Benchmark Level 1",
        "macos_security/sysprefs_guest_account_disable"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Guest account enabled",
          "summary": "Guest account is enabled. This is usually fine but it's not that easy to limit access to your data. You should disable it."
        },
        {
          "locale": "FR",
          "title": "Compte invit\u00e9 activ\u00e9",
          "summary": "Le compte invit\u00e9 est activ\u00e9. C'est g\u00e9n\u00e9ralement bien, mais il n'est pas si facile de limiter l'acc\u00e8s \u00e0 vos donn\u00e9es. Vous devriez le d\u00e9sactiver."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "sysadminctl -guestAccount status 2>&1 | grep enabled",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "sysadminctl -guestAccount off",
        "education": []
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "sysadminctl -guestAccount on",
        "education": []
      }
    },
    {
      "name": "root user enabled",
      "metrictype": "bool",
      "dimension": "system integrity",
      "severity": 3,
      "scope": "macOS",
      "tags": [],
      "description": [
        {
          "locale": "EN",
          "title": "Root user enabled",
          "summary": "A special system user has been configured on your computer. This is unusual and should be disabled immediately."
        },
        {
          "locale": "FR",
          "title": "Utilisateur root activ\u00e9",
          "summary": "Un utilisateur syst\u00e8me sp\u00e9cial a \u00e9t\u00e9 configur\u00e9 sur votre ordinateur. Ceci est inhabituel et doit \u00eatre d\u00e9sactiv\u00e9 imm\u00e9diatement."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "dscl . -read /Users/root Password | grep \"\\*\\*\"",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "",
        "elevation": "",
        "target": "",
        "education": [
          {
            "locale": "EN",
            "class": "youtube",
            "target": "https://www.youtube.com/watch?v=Sx8o8C1oqyc"
          },
          {
            "locale": "FR",
            "class": "youtube",
            "target": "https://www.youtube.com/watch?v=Bw05ksrrD4g"
          }
        ]
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "",
        "elevation": "",
        "target": "",
        "education": [
          {
            "locale": "EN",
            "class": "youtube",
            "target": "https://www.youtube.com/watch?v=Sx8o8C1oqyc"
          },
          {
            "locale": "FR",
            "class": "youtube",
            "target": "https://www.youtube.com/watch?v=Bw05ksrrD4g"
          }
        ]
      }
    },
    {
      "name": "unprotected system wide changes",
      "metrictype": "bool",
      "dimension": "system integrity",
      "severity": 3,
      "scope": "macOS",
      "tags": [
        "CIS Benchmark Level 1",
        "macos_security/sysprefs_system_wide_preferences_configure"
      ],
      "description": [
        {
          "locale": "EN",
          "title": "Unprotected system changes",
          "summary": "Your computer system settings can be modified by any users. You should restrict it."
        },
        {
          "locale": "FR",
          "title": "Changement de param\u00e8tres syst\u00e8me non prot\u00e9g\u00e9s",
          "summary": "Les param\u00e8tres de votre syst\u00e8me informatique peuvent \u00eatre modifi\u00e9s par tous les utilisateurs. Vous devriez le restreindre."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "user",
        "target": "security authorizationdb read system.preferences 2> /dev/null | grep -A1 shared | grep true",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "security authorizationdb read system.preferences > /tmp/system.preferences.plist; /usr/libexec/PlistBuddy -c \"Set :shared false\" /tmp/system.preferences.plist; security authorizationdb write system.preferences < /tmp/system.preferences.plist",
        "education": []
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "system",
        "target": "security authorizationdb read system.preferences > /tmp/system.preferences.plist; /usr/libexec/PlistBuddy -c \"Set :shared true\" /tmp/system.preferences.plist; security authorizationdb write system.preferences < /tmp/system.preferences.plist",
        "education": []
      }
    },
    {
      "name": "pwned",
      "metrictype": "bool",
      "dimension": "credentials",
      "severity": 1,
      "scope": "generic",
      "tags": [],
      "description": [
        {
          "locale": "EN",
          "title": "Compromised Apple ID",
          "summary": "Your Apple ID email has recently appeared in a data breach, please review the breach and change your passwords accordingly."
        },
        {
          "locale": "FR",
          "title": "Apple ID compromise",
          "summary": "Votre e-mail Apple ID est apparue r\u00e9cemment dans une fuite de donn\u00e9es, veuillez examiner la fuite et modifier vos mots de passe en cons\u00e9quence."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "internal",
        "elevation": "user",
        "target": "pwned -i 365",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "internal",
        "elevation": "",
        "target": "digitalidentity_manager",
        "education": []
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "",
        "elevation": "",
        "target": "",
        "education": [
          {
            "locale": "EN",
            "class": "link",
            "target": "https://haveibeenpwned.com/"
          },
          {
            "locale": "FR",
            "class": "link",
            "target": "https://haveibeenpwned.com/"
          }
        ]
      }
    },
    {
      "name": "latest os",
      "metrictype": "bool",
      "dimension": "system integrity",
      "severity": 2,
      "scope": "generic",
      "tags": [],
      "description": [
        {
          "locale": "EN",
          "title": "Your OS is not up to date",
          "summary": "Your operating system is not up to date, please proceed to upgrade to get the latest security patches."
        },
        {
          "locale": "FR",
          "title": "Votre OS n'est pas \u00e0 jour",
          "summary": "Votre syst\u00e8me d'exploitation n'est pas \u00e0 jour, veuillez proc\u00e9der \u00e0 sa mise \u00e0 niveau afin d'obtenir les derniers correctifs de s\u00e9curit\u00e9."
        }
      ],
      "implementation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "cli",
        "elevation": "admin",
        "target": "defaults read /Library/Preferences/com.apple.SoftwareUpdate.plist | grep macOS",
        "education": []
      },
      "remediation": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "",
        "elevation": "",
        "target": "",
        "education": [
          {
            "locale": "EN",
            "class": "youtube",
            "target": "https://www.youtube.com/watch?v=FG2DXkPA93g&t=124s"
          },
          {
            "locale": "FR",
            "class": "youtube",
            "target": "https://www.youtube.com/watch?v=FG2DXkPA93g&t=124s"
          }
        ]
      },
      "rollback": {
        "system": "macOS",
        "minversion": 12,
        "maxversion": 0,
        "class": "",
        "elevation": "",
        "target": "",
        "education": [
          {
            "locale": "EN",
            "class": "youtube",
            "target": "https://www.youtube.com/watch?v=FG2DXkPA93g&t=124s"
          },
          {
            "locale": "FR",
            "class": "youtube",
            "target": "https://www.youtube.com/watch?v=FG2DXkPA93g&t=124s"
          }
        ]
      }
    }
  ]
}