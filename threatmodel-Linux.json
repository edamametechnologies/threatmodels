{
    "name": "threat model Linux",
    "extends": "none",
    "date": "June 06th 2023",
    "signature": "480e676536e77cea30e032fb7c8afd45b65c16dc9820a21c0d293f631982f428",
    "metrics": [
        {
            "name": "edamame helper disabled",
            "metrictype": "bool",
            "dimension": "system services",
            "severity": 5,
            "scope": "generic",
            "tags": [],
            "description": [
                {
                    "locale": "EN",
                    "title": "Edamame helper inactive",
                    "summary": "Edamame's Helper software is not running or requires an update. It's required for maximum Security Score analysis."
                },
                {
                    "locale": "FR",
                    "title": "Edamame Helper inactif",
                    "summary": "Le logiciel d'assistance d'Edamame n'est pas en cours d'ex\u00e9cution ou a besoin d'\u00eatre mis \u00e0 jour. Il est requis pour une analyse compl\u00e8te du score de s\u00e9curit\u00e9."
                }
            ],
            "implementation": {
                "system": "Linux",
                "minversion": 6,
                "maxversion": 0,
                "class": "cli",
                "elevation": "admin",
                "target": "ps -ef | grep edamame_helper | grep -v grep > /dev/null || echo nohelper",
                "education": []
            },
            "remediation": {
                "system": "Linux",
                "minversion": 6,
                "maxversion": 0,
                "class": "installer",
                "elevation": "user",
                "target": "",
                "education": []
            },
            "rollback": {
                "system": "Linux",
                "minversion": 6,
                "maxversion": 0,
                "class": "cli",
                "elevation": "system",
                "target": "",
                "education": []
            }
        },
        {
            "name": "/etc/passwd permissions",
            "metrictype": "bool",
            "dimension": "system integrity",
            "severity": 5,
            "scope": "generic",
            "tags": [],
            "description": [
                {
                    "locale": "EN",
                    "title": "File permissions /etc/passwd",
                    "summary": "The /etc/passwd file in Unix and Linux systems contains user account information. The recommended permissions for this file are 644. This means:\nThe owner (usually root) has read and write permissions (6).\nThe group and other users have read-only permissions (4).\nThis setup ensures that only the superuser can modify the file, preserving system security. Meanwhile, other users and processes can still read the information they need from the file. This balance of functionality and security is why 644 permissions are considered good practice for the /etc/passwd file."
                },
                {
                    "locale": "FR",
                    "title": "Permissions du fichier /etc/passwd",
                    "summary": "Le fichier `/etc/passwd` dans les syst\u00e8mes Unix et Linux contient des informations sur les comptes utilisateurs. Les permissions recommand\u00e9es pour ce fichier sont `644`. Cela signifie que :\n- Le propri\u00e9taire (g\u00e9n\u00e9ralement `root`) a les permissions de lecture et d'\u00e9criture (6).\n- Le groupe et les autres utilisateurs ont les permissions de lecture seule (4).\nCette configuration garantit que seul le superutilisateur peut modifier le fichier, pr\u00e9servant ainsi la s\u00e9curit\u00e9 du syst\u00e8me. Pendant ce temps, les autres utilisateurs et processus peuvent toujours lire les informations dont ils ont besoin \u00e0 partir du fichier. Cet \u00e9quilibre entre fonctionnalit\u00e9 et s\u00e9curit\u00e9 est la raison pour laquelle les permissions `644` sont consid\u00e9r\u00e9es comme une bonne pratique pour le fichier `/etc/passwd`."
                }
            ],
            "implementation": {
                "system": "Linux",
                "minversion": 6,
                "maxversion": 0,
                "class": "cli",
                "elevation": "system",
                "target": "stat /etc/passwd | grep '(0644/-rw-r--r--)' | grep -v grep > /dev/null || echo bad_permissions",
                "education": []
            },
            "remediation": {
                "system": "Linux",
                "minversion": 6,
                "maxversion": 0,
                "class": "cli",
                "elevation": "system",
                "target": "chmod 664 /etc/passwd",
                "education": []
            },
            "rollback": {
                "system": "Linux",
                "minversion": 6,
                "maxversion": 0,
                "class": "",
                "elevation": "",
                "target": "",
                "education": []
            }
        },
        {
            "name": "/etc/shadow permissions",
            "metrictype": "bool",
            "dimension": "system integrity",
            "severity": 5,
            "scope": "generic",
            "tags": [],
            "description": [
                {
                    "locale": "EN",
                    "title": "File permissions /etc/shadow",
                    "summary": "The /etc/shadow file in Unix and Linux systems stores encrypted password data for each user and has stricter permissions than /etc/passwd. This is because /etc/shadow contains sensitive data.\nThe recommended permissions for the /etc/shadow file are 600:\n6 (read and write) for the owner, who should be the root or superuser. This allows the system to modify the file when passwords are changed.\n0 for the group and others. This means no permissions are given to the group or others, meaning they cannot read, write, or execute the file."
                },
                {
                    "locale": "FR",
                    "title": "Permissions du fichier /etc/shadow",
                    "summary": "Le fichier `/etc/shadow` dans les syst\u00e8mes Unix et Linux stocke les donn\u00e9es de mot de passe crypt\u00e9es pour chaque utilisateur et a des permissions plus strictes que `/etc/passwd`. Cela est d\u00fb au fait que `/etc/shadow` contient des donn\u00e9es sensibles.\nLes permissions recommand\u00e9es pour le fichier `/etc/shadow` sont `600` :\n- `6` (lecture et \u00e9criture) pour le propri\u00e9taire, qui devrait \u00eatre l'utilisateur root ou superutilisateur. Cela permet au syst\u00e8me de modifier le fichier lorsque les mots de passe sont chang\u00e9s.\n- `0` pour le groupe et les autres. Cela signifie qu'aucune permission n'est donn\u00e9e au groupe ou aux autres, ce qui signifie qu'ils ne peuvent pas lire, \u00e9crire ou ex\u00e9cuter le fichier."
                }
            ],
            "implementation": {
                "system": "Linux",
                "minversion": 6,
                "maxversion": 0,
                "class": "cli",
                "elevation": "system",
                "target": "stat /etc/shadow | grep '(0600/-rw-------)' | grep -v grep > /dev/null || echo bad_permissions",
                "education": []
            },
            "remediation": {
                "system": "Linux",
                "minversion": 6,
                "maxversion": 0,
                "class": "cli",
                "elevation": "system",
                "target": "chmod 600 /etc/shadow",
                "education": []
            },
            "rollback": {
                "system": "Linux",
                "minversion": 6,
                "maxversion": 0,
                "class": "",
                "elevation": "",
                "target": "",
                "education": []
            }
        },
        {
            "name": "/etc/fstab permissions",
            "metrictype": "bool",
            "dimension": "system integrity",
            "severity": 5,
            "scope": "generic",
            "tags": [],
            "description": [
                {
                    "locale": "EN",
                    "title": "File permissions /etc/fstab",
                    "summary": "The `/etc/fstab` file in Unix and Linux systems provides a table of filesystems that should be mounted automatically at system startup. This file contains important information like what filesystems to mount, where to mount them, and what options to use.\nGiven its significance, the recommended permissions for the `/etc/fstab` file are `644`:\n- `6` (read and write) for the owner, which should be the root or superuser. This allows the system to modify the file when filesystems are added or removed.\n- `4` (read-only) for the group and others. This allows users and processes to read the file and understand the system's filesystems, but prevents them from making potentially harmful changes.\nThis setup ensures only the root user can modify the file, protecting the system's filesystem configuration. Meanwhile, it allows other users and processes to read the file, providing necessary access to filesystem information."
                },
                {
                    "locale": "FR",
                    "title": "Permissions du fichier /etc/fstab",
                    "summary": "Le fichier `/etc/fstab` dans les syst\u00e8mes Unix et Linux fournit une table des syst\u00e8mes de fichiers qui doivent \u00eatre mont\u00e9s automatiquement au d\u00e9marrage du syst\u00e8me. Ce fichier contient des informations importantes telles que les syst\u00e8mes de fichiers \u00e0 monter, o\u00f9 les monter et quelles options utiliser.\nCompte tenu de son importance, les permissions recommand\u00e9es pour le fichier `/etc/fstab` sont `644` :\n- `6` (lecture et \u00e9criture) pour le propri\u00e9taire, qui devrait \u00eatre l'utilisateur root ou superutilisateur. Cela permet au syst\u00e8me de modifier le fichier lorsque des syst\u00e8mes de fichiers sont ajout\u00e9s ou supprim\u00e9s.\n- `4` (lecture seule) pour le groupe et les autres. Cela permet aux utilisateurs et aux processus de lire le fichier et de comprendre les syst\u00e8mes de fichiers du syst\u00e8me, mais les emp\u00eache d'apporter des modifications potentiellement nuisibles.\nCette configuration garantit que seul l'utilisateur root peut modifier le fichier, prot\u00e9geant ainsi la configuration du syst\u00e8me de fichiers du syst\u00e8me. En m\u00eame temps, elle permet aux autres utilisateurs et processus de lire le fichier, fournissant l'acc\u00e8s n\u00e9cessaire aux informations sur le syst\u00e8me de fichiers."
                }
            ],
            "implementation": {
                "system": "Linux",
                "minversion": 6,
                "maxversion": 0,
                "class": "cli",
                "elevation": "system",
                "target": "stat /etc/fstab | grep '(0644/-rw-r--r--)' | grep -v grep > /dev/null || echo bad_permissions",
                "education": []
            },
            "remediation": {
                "system": "Linux",
                "minversion": 6,
                "maxversion": 0,
                "class": "cli",
                "elevation": "system",
                "target": "chmod 644 /etc/fstab",
                "education": []
            },
            "rollback": {
                "system": "Linux",
                "minversion": 6,
                "maxversion": 0,
                "class": "",
                "elevation": "",
                "target": "",
                "education": []
            }
        },
        {
            "name": "/etc/group permissions",
            "metrictype": "bool",
            "dimension": "system integrity",
            "severity": 5,
            "scope": "generic",
            "tags": [],
            "description": [
                {
                    "locale": "EN",
                    "title": "File permissions /etc/group",
                    "summary": "The `/etc/group` file in Unix and Linux systems stores group information or data. It contains a list of all the groups on the system, along with each group's associated users.\nGiven its importance, the recommended permissions for the `/etc/group` file are `644`:\n- `6` (read and write) for the owner, which should be the root or superuser. This allows the system to add or remove groups or modify group membership.\n- `4` (read-only) for the group and others. This allows users and processes to read the file and understand the system's group memberships, but prevents them from making unauthorized changes.\nThis setup ensures only the root user can modify the file, protecting the system's group configuration. Meanwhile, it allows other users and processes to read the file, providing necessary access to group information."
                },
                {
                    "locale": "FR",
                    "title": "Permissions du fichier /etc/group",
                    "summary": "Le fichier `/etc/group` dans les syst\u00e8mes Unix et Linux stocke les informations ou les donn\u00e9es des groupes. Il contient une liste de tous les groupes sur le syst\u00e8me, ainsi que les utilisateurs associ\u00e9s \u00e0 chaque groupe.\nCompte tenu de son importance, les permissions recommand\u00e9es pour le fichier `/etc/group` sont `644` :\n- `6` (lecture et \u00e9criture) pour le propri\u00e9taire, qui devrait \u00eatre l'utilisateur root ou superutilisateur. Cela permet au syst\u00e8me d'ajouter ou de supprimer des groupes ou de modifier l'appartenance \u00e0 un groupe.\n- `4` (lecture seule) pour le groupe et les autres. Cela permet aux utilisateurs et aux processus de lire le fichier et de comprendre l'appartenance aux groupes du syst\u00e8me, mais les emp\u00eache de faire des modifications non autoris\u00e9es.\nCette configuration garantit que seul l'utilisateur root peut modifier le fichier, prot\u00e9geant ainsi la configuration des groupes du syst\u00e8me. En m\u00eame temps, elle permet aux autres utilisateurs et processus de lire le fichier, fournissant l'acc\u00e8s n\u00e9cessaire aux informations sur les groupes."
                }
            ],
            "implementation": {
                "system": "Linux",
                "minversion": 6,
                "maxversion": 0,
                "class": "cli",
                "elevation": "system",
                "target": "stat /etc/group | grep '(0644/-rw-r--r--)' | grep -v grep > /dev/null || echo bad_permissions",
                "education": []
            },
            "remediation": {
                "system": "Linux",
                "minversion": 6,
                "maxversion": 0,
                "class": "cli",
                "elevation": "system",
                "target": "chmod 644 /etc/group",
                "education": []
            },
            "rollback": {
                "system": "Linux",
                "minversion": 6,
                "maxversion": 0,
                "class": "",
                "elevation": "",
                "target": "",
                "education": []
            }
        },
        {
            "name": "/etc/group group",
            "metrictype": "bool",
            "dimension": "system integrity",
            "severity": 5,
            "scope": "generic",
            "tags": [],
            "description": [
                {
                    "locale": "EN",
                    "title": "",
                    "summary": ""
                },
                {
                    "locale": "FR",
                    "title": "",
                    "summary": ""
                }
            ],
            "implementation": {
                "system": "Linux",
                "minversion": 6,
                "maxversion": 0,
                "class": "cli",
                "elevation": "system",
                "target": "ls -l /etc/group | grep 'root root' | grep -v grep > /dev/null || echo bad_group",
                "education": []
            },
            "remediation": {
                "system": "Linux",
                "minversion": 6,
                "maxversion": 0,
                "class": "cli",
                "elevation": "system",
                "target": "chown root /etc/group",
                "education": []
            },
            "rollback": {
                "system": "Linux",
                "minversion": 6,
                "maxversion": 0,
                "class": "",
                "elevation": "",
                "target": "",
                "education": []
            }
        },
        {
            "name": "/etc/shadow group",
            "metrictype": "bool",
            "dimension": "system integrity",
            "severity": 5,
            "scope": "generic",
            "tags": [],
            "description": [
                {
                    "locale": "EN",
                    "title": "Permissions checks",
                    "summary": ""
                },
                {
                    "locale": "FR",
                    "title": "",
                    "summary": ""
                }
            ],
            "implementation": {
                "system": "Linux",
                "minversion": 6,
                "maxversion": 0,
                "class": "cli",
                "elevation": "system",
                "target": "ls -l /etc/shadow | grep 'root root' | grep -v grep > /dev/null || echo bad_group",
                "education": []
            },
            "remediation": {
                "system": "Linux",
                "minversion": 6,
                "maxversion": 0,
                "class": "cli",
                "elevation": "system",
                "target": "chown root /etc/shadow",
                "education": []
            },
            "rollback": {
                "system": "Linux",
                "minversion": 6,
                "maxversion": 0,
                "class": "",
                "elevation": "",
                "target": "",
                "education": []
            }
        },
        {
            "name": "restrict cron to root",
            "metrictype": "bool",
            "dimension": "system integrity",
            "severity": 5,
            "scope": "generic",
            "tags": [],
            "description": [
                {
                    "locale": "EN",
                    "title": "Cron is not restricted to root only",
                    "summary": "Cron is a time-based job scheduler in Unix-like operating systems. Users can schedule jobs (commands or scripts) to run periodically at fixed times, dates, or intervals. It's a powerful tool, but can also pose security risks if not managed properly. Restricting cron jobs to the root user is generally considered good practice."
                },
                {
                    "locale": "FR",
                    "title": "Cron n'est pas restreint \u00e0 l'utilisateur root",
                    "summary": "Cron est un planificateur de t\u00e2ches bas\u00e9 sur le temps dans les syst\u00e8mes d'exploitation de type Unix. Les utilisateurs peuvent programmer des t\u00e2ches (commandes ou scripts) pour qu'elles s'ex\u00e9cutent p\u00e9riodiquement \u00e0 des heures, des dates ou des intervalles fixes. C'est un outil puissant, mais qui peut \u00e9galement poser des risques de s\u00e9curit\u00e9 s'il n'est pas g\u00e9r\u00e9 correctement. Restreindre les t\u00e2ches cron \u00e0 l'utilisateur root est g\u00e9n\u00e9ralement consid\u00e9r\u00e9 comme une bonne pratique."
                }
            ],
            "implementation": {
                "system": "Linux",
                "minversion": 6,
                "maxversion": 0,
                "class": "cli",
                "elevation": "system",
                "target": "cd /etc ; [ -f cron.deny ] && echo bad_config ; grep -v root cron.allow",
                "education": []
            },
            "remediation": {
                "system": "Linux",
                "minversion": 6,
                "maxversion": 0,
                "class": "cli",
                "elevation": "system",
                "target": "cd /etc ; [ -f cron.deny ] && mv cron.deny cron.deny.edamame_save ; [ -f cron.allow ] && mv cron.allow cron.allow.edamame_save ; echo root > cron.allow ; chown root cron.allow ; chmod 400 cron.allow",
                "education": []
            },
            "rollback": {
                "system": "Linux",
                "minversion": 6,
                "maxversion": 0,
                "class": "",
                "elevation": "",
                "target": "",
                "education": []
            }
        },
        {
            "name": "check system updates",
            "metrictype": "bool",
            "dimension": "system integrity",
            "severity": 5,
            "scope": "generic",
            "tags": [],
            "description": [
                {
                    "locale": "EN",
                    "title": "Missing system updates",
                    "summary": "Keeping a Linux system (or any operating system) up-to-date is crucial for several reasons, particularly when it comes to security: developers regularly find and fix security vulnerabilities in software. These fixes, known as patches, are distributed via updates. By regularly updating your system, you ensure these patches are applied promptly, reducing the chance of a successful attack."
                },
                {
                    "locale": "FR",
                    "title": "Syst\u00e8me non \u00e0 jour",
                    "summary": "Garder un syst\u00e8me Linux (ou tout autre syst\u00e8me d'exploitation) \u00e0 jour est crucial pour plusieurs raisons, en particulier en ce qui concerne la s\u00e9curit\u00e9 : les d\u00e9veloppeurs trouvent et corrigent r\u00e9guli\u00e8rement des vuln\u00e9rabilit\u00e9s de s\u00e9curit\u00e9 dans les logiciels. Ces correctifs, appel\u00e9s patches, sont distribu\u00e9s via des mises \u00e0 jour. En mettant r\u00e9guli\u00e8rement \u00e0 jour votre syst\u00e8me, vous assurez l'application rapide de ces patches, r\u00e9duisant ainsi les chances d'une attaque r\u00e9ussie."
                }
            ],
            "implementation": {
                "system": "Linux",
                "minversion": 6,
                "maxversion": 0,
                "class": "cli",
                "elevation": "system",
                "target": "checkupdates; [ $? -eq 0 ] && echo updates_required",
                "education": []
            },
            "remediation": {
                "system": "Linux",
                "minversion": 6,
                "maxversion": 0,
                "class": "cli",
                "elevation": "system",
                "target": "pacman -Syu --noconfirm",
                "education": []
            },
            "rollback": {
                "system": "Linux",
                "minversion": 6,
                "maxversion": 0,
                "class": "",
                "elevation": "",
                "target": "",
                "education": []
            }
        },
        {
            "name": "password duration",
            "metrictype": "bool",
            "dimension": "Credentials",
            "severity": 3,
            "scope": "generic",
            "tags": [],
            "description": [
                {
                    "locale": "EN",
                    "title": "Permissions checks",
                    "summary": ""
                },
                {
                    "locale": "FR",
                    "title": "",
                    "summary": ""
                }
            ],
            "implementation": {
                "system": "Linux",
                "minversion": 6,
                "maxversion": 0,
                "class": "cli",
                "elevation": "system",
                "target": "[ $(grep '^PASS_MAX_DAYS' /etc/login.defs | awk '{print $NF}') -lt 90 ] || echo pass_max_days_too_long",
                "education": []
            },
            "remediation": {
                "system": "Linux",
                "minversion": 6,
                "maxversion": 0,
                "class": "cli",
                "elevation": "system",
                "target": "",
                "education": []
            },
            "rollback": {
                "system": "Linux",
                "minversion": 6,
                "maxversion": 0,
                "class": "",
                "elevation": "",
                "target": "",
                "education": []
            }
        },
        {
            "name": "uncomplicated firewall",
            "metrictype": "bool",
            "dimension": "network",
            "severity": 3,
            "scope": "generic",
            "tags": [],
            "description": [
                {
                    "locale": "EN",
                    "title": "Uncomplicated firewall not installed",
                    "summary": "A firewall is a crucial part of any network security framework. Firewalls control the incoming and outgoing network traffic based on predetermined security rules. They establish a barrier between trusted internal networks and untrusted external networks. It can also block unauthorized access to or from private networks, preventing intruders from accessing sensitive information. Uncomplicated firewall provides a command line interface and aims to be uncomplicated and easy to use."
                },
                {
                    "locale": "FR",
                    "title": "Uncomplicated firewall non install\u00e9",
                    "summary": "Un pare-feu est un \u00e9l\u00e9ment crucial de tout cadre de s\u00e9curit\u00e9 r\u00e9seau. Les pare-feu contr\u00f4lent le trafic r\u00e9seau entrant et sortant en fonction de r\u00e8gles de s\u00e9curit\u00e9 pr\u00e9d\u00e9termin\u00e9es. Ils \u00e9tablissent une barri\u00e8re entre les r\u00e9seaux internes de confiance et les r\u00e9seaux externes non fiables. Il peut \u00e9galement bloquer l'acc\u00e8s non autoris\u00e9 vers ou depuis des r\u00e9seaux priv\u00e9s, emp\u00eachant les intrus d'acc\u00e9der \u00e0 des informations sensibles. Uncomplicated firewall fournit une interface en ligne de commande et vise \u00e0 \u00eatre simple d'utilisation."
                }
            ],
            "implementation": {
                "system": "Linux",
                "minversion": 6,
                "maxversion": 0,
                "class": "cli",
                "elevation": "system",
                "target": "pacman -Qi ufw > /dev/null || echo not_found",
                "education": []
            },
            "remediation": {
                "system": "Linux",
                "minversion": 6,
                "maxversion": 0,
                "class": "cli",
                "elevation": "system",
                "target": "pacman -S ufw; ufw enable; ufw default deny; ufw allow from 192.168.0.0/24; ufw allow Deluge; ufw limit ssh",
                "education": [
                    {
                        "locale": "EN",
                        "class": "link",
                        "target": "https://wiki.archlinux.org/title/Uncomplicated_Firewall"
                    }
                ]
            },
            "rollback": {
                "system": "Linux",
                "minversion": 6,
                "maxversion": 0,
                "class": "",
                "elevation": "",
                "target": "pacman -R ufw",
                "education": []
            }
        }
    ]
}